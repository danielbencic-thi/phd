Polytime Algorithm for the Shortest Path

in a Homotopy Class

amidst Semi-Algebraic Obstacles in the Plane

D. Grigoriev1
Department of Computer Science, Penn State University, USA and
Steklov Institute for Mathematics, Academy of Sciences of Russia,
St-Petersburg, Russia

A. Slissenko2]
Department of Informatics, University Paris-12, France
and Institute for Informatics, Academy of Sciences of Russia,
St-Petersburg, Russia

Version of November 27, 1997

Abstract
Given a set of semi-algebraic obstacles in the plane and two points in the same connected component of the complement, the problem is to construct the shortest path between these points in a given homotopy class. This path is unique and has some canonical form. We use the representation of homotopy classes in a way that is as general as the classical one. It consists in representing generators of a free group which describes the classes of homotopy by disjoint cuts GS97] homeomorphic to rays. We show that given such a system of generators and a word representing a homotopy class, one can contruct the shortest path of this class in time polynomial in the size of the word and in the size of the representation of the obstacles and the cuts. The homotopy class may also be represented by a path, then the polynomial complexity will depend on the size of the representation of this path. As a technical notion we introduce one particular system of cuts, which we call an extremity basis, that proves to be especially convenient for algorithmic purposes. The considered problem is motivated by robot motion planning and by theoretical questions arising in shortest path approximations in higher dimensions.

1Address: Dept. of Comput. Sci., Penn State University, University Park, PA 16802, USA. E-mail: grigorie@cse.psu.edu
Supported by NSF grant CCR-9424358. 2Address: Dept. of Informatics, University Paris-12, 61 Av. du Gen. de Gaulle, 94010, Creteil, France. E-mail: slissenko@univ-paris12.fr ]Partially supported by INTAS-93-2530-ext project.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

1

1 Introduction.

We consider the problem of constructing the shortest path of a given homotopy class between two points in a connected component of the complement of semi-algebraic obstacles. The problem of the shortest path is well known, e. g. see the surveys SS90, MS95], and in particular has a motivation that arises from robot motion planning Can88, Lat91]. It was considered mainly for the case of polygonal obstacles in the plane, for which case many algorithms have been developed. For the case of polyhedral obstacles in 3-dimensional Euclidean space it is NP-hard CR87] in the general case, though admits polytime algorithms in some particular cases (see the surveys mentioned above). And in any case of polyhedral obstacles a path which length is "-close to the length of the shortest path, can be found in ttoimbeepgoilvyennombyiatlhienir1"vaenrtdiciensthPeaspi8z5e,oCf SthYe9r4e]p. resentation of the obstacles that are presumed The case of semi-algebraic obstacles in the plane had been considered in HKSS94] where it was shown that a shortest path can be constructed in polytime by an extended version of real RAM BSS89] that is able to calculate in polytime integrals of algebraic functions. Slight development of the construction of HKSS94] gives an algorithm for a usual RAM (as, e. g. in Pap94]) that outputs a path whose length is "-close to the shortest path length and which time complexity is polynomial in the complexity of representation of obstacles and in Cloogn1"s.tructing the shortest path in a given homotopy class was considered for polygonal obstacles in the plane in HS94], but within a rather restricted setting. Namely, the space admissible for paths is a boundary-triangulated 2-manifold. Such a manifold is a simplicial complex in which all vertices are boundary vertices. Homotopy classes are represented by paths. This particular triangulation permits to construct straightforwardly a covering space and easily nd the shortest path homotopic to the given one. The e orts of HS94] are concentrated on other kind of problems related to unifying treatments of various metrics and improving particular data structures.
Our result. We show that for the case of semi-algebraic obstacles in the plane and for
rather general way of representing classes of homotopy the problem of constructing the shortest path of a given homotopy class is solvable in time polynomial in the size of all input data (i. e. in the size of representation of obstacles and of the homotopy class) for bitwise models of computation, e. g. for a usual RAM, see the theorem at the end of the paper (section 3.2). A homotopy class may be represented as an arbitrary semi-algebraic path or, and what is more interesting, as a word in a free group describing the homotopy classes with the same generality as the classical approaches ST80]. As such a representation we consider a set of pairwise disjoint semi-algebraic cuts homeomorphic to rays and emanating from each component obstacle. This type of representation which is, in a way, dual to the classical one ST80], was considered in GS97]. As a technical notion we introduce one particular system of cuts, which we call an extremity basis, that proves to be especially convenient for algorithmic purposes.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

2

1.1 Semi-Algebraic Obstacles In the Plane.

A semi-algebraic BCR87] set S in the plane is a set represented by a disjunctive normal

form formula which atoms are polynomial equations and inequalities:

_ ^ fi;j!i;j0

(1)

1 i N1 1 j N2

where fi;j 2 Z x; y] and !i;j 2 f ; <; =g.
We treat the set as representing obstacles in a natural way, some precisions being given

below. The set S may consist of many connected components that can be found in poly-

time Gri88, HRS90, GV92, Ren92]. Zero-dimensional componets, i. e. isolated points, can

hardly be treated as obstacles, so we exclude them from the set in polytime. These points

can be easily described by a formula of Tarski algebra with small number of quanti ers and

containing polynomials of small number of variables.

As we consider the complexity on a qualitative level, namely, polynomial versus non polyno-

mial, we do not need to go into details of descriptions of the sets under consideration. Our

starting set is S of the form (1), and the complexity of its representations is measured by

the following parameters: least integer such that 2M

d, the maximum of is greater or equal to

degrees of the polynomials fij, the absolute values of the coe

and M, cients of

the fij.

Related sets such as the closure S, the interior S , the boundary S , the complement coS of

S, the set of isolated points of S etc. can be represented by formulas of Tarski algebra which

number of quanti ers and number of variables are bounded by a constant, and which size is

bounded by a polynomial in the size of the formula (1). We need a procedure which, given

such a set, constructs its connected components and a procedure that recognizes whether

two points are in the same connected component. Within the mentioned context such poly-

time procedures are known (see GHR+90, GV88, HRS94, CGV92], for 2-dimensional case

see also AM88]).

To avoid trivialities and assure the existence of the shortest paths we make some polytime

transformations of the initial set S. We suppose that the set is inside some square which

complement is an obstacle. We eliminate isolated points of the set S. Furthermore, we wish

to leave only one connected component for the trajectories. To do it we nd the connected

components of the complement of S and append to the obstacles all components of the com-

plement except the one we are interested in and which is determined by the given end points

of the paths under consideration. Thus, we have a set S without isolated points and which

complement is 1-connected. Consider its boundary S .

To make the treatment of obstacles technically simpler we slightly transform them. To de-

scribe the transformations and other notions, introduce some notations:

"B-n?(Xeia;gnrh)dboisrha+onododepnoeofntaebasreleltscpUeencittseivrBeed(lyUa;tt"hX)e=ldaeffntSdaXon2fdUrarBdigi(huXts;er"n,)d;anodf

B(X; r) is its closure; an ordered simple path

, in

particular, of a segment.

Now we wish to "slightly in ate" 1-dimensional pieces of S to make them 2-dimensional with some interior. For this purpose we use extensions of reals by in nitesimals as in GV88] where one can nd necessary algorithmic technique. Remind that such an extension of a real closed eld K starts by introducing a formal variable, say , with the property: 0 < < for all positive elements from K. This element is called in nitesimal over K. It is,

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

3

bcleeadrelyn,ottreadnsbcyenKdge(n)t.al

over K. Then we For an element

coofnKsgid(e)r

the its

real closure of standard part

the eld K( belonging to

) that will K can be

de ned, see GV88], and will but in our case will always

be lie

denoted in a ball

by stK( ) (it is centered in the

not de ned if origin and with

is a

riandinuistefrlyomlarRge,

tQh,erQfef,oQfre(st)K,
, and write

(Qg() w) ieltlcb.eAalwealydsKdebeniendg).
0 << , if 0 is in nitesimal

In algorithmic constructions we actually deal with xfoerd,Kgw(e )s.ay that 0 is in nitesimal with respect to

Summarize the notations related to in nitesimals:

> 0 will be an element in nitesimal relatively to R, and two more in nitesimals

0

<R02=<df<Rg(1

<<
), R1

=dwf iRllg0b(e1n)eaenddedR. 2=df

Rg1( 2

).

aWTBloegele"obwiwnrialwliaceit)deces"onenttthisfiieynde1aRr-dsnitiehmtdeeeifnnonsrRiemodnnuabldalyesistdonheleeadtnseaibdnmygpeaioefbcfooserrtsmmaocufullealtash,oeovbfbearTolluaRsnresidtkicaif.ryaiot,lvgdreeeorbperolsaancneoeovottefhrlteeRhaoedbwmsttoietahnactlmetiohsb,neigoe(dursieotRmny.liiy-.

those points of them that do not contain points of S in its small enough neighborhood, by

their -neighborhoods. This can be described in Tarski Algebra over the eld extended by

, and thus the appropriate algorithms must be used to nd the connected components, see

GHR+90, GV92, CGV92, HRS94].

Fsscpirnaicabeleldyc,oal?betowv?eil,lbabenedthceallcbeledosiutthsreeboofrufenetdhsaepraysec(teroeamfndoinb?dest=tahcdfaletswoebcctoao?innsewiddiellarfbttheeretothhneeststaprcaalcenessfoaovdremmraiRstsi0oib)n.lseTdfhoeer-
trajectories we are going to consider. The trajectories can go anywhere in the free space,

they are forbidden to go through boundaries though allowed to border them alongside. In

the admissible space a shortest path between two points always exists and is semi-algebraic

HKSS94], and it is not unique in see below). We will denote the

cthhoesgeenneernadlscaosfet(rbaujetcittoirsieusnbiqyuse

inanadgitve(nfrhomomroetsoppeyctcilvaeslsy,

"source" and "target", a usual notation in robot motion planning), and for technical reasons

will assume them to lie in the free space (otherwise replace them by in nitely close ones in

the To

free space). summarize the

resulting

properties

of

the

situation

note

that

?e

(assumed

to

be

non

empty) consists of only one connected component and that all the connected components of

the obstacles are closed semi-algebraic sets with non empty 1-connected interior (i. e. such

that any loop in the interior is contractible ST80]) and without non degenerated boundary

that means, in particular, that from any point of the boundary one can make a small de-

placement into the interior of the component. A connected component of the obstacles will

be called a component obstacle or simply an obstacle.

1.2 The Shortest Path Problem

A or

path or curve is a continuous piecewise smooth image a quasi-segment is a path without self-intersections.

of a We

closed segment. A simple consider only paths lying

pinat?he

and not intersecting .

A path intersects the boundary at its point X 2 if for all small enough " > 0 there

is a closed quasi-segment \ B(X; ") such that (B(X; "2) n ) consists of two connected

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

4

components each containing points of . A path intersects the obstacles if it either intersects

tAhepabtohuninda?eryisoardcmonistsaiibnles admissible paths between

interior points of the obstacles.

if it two

doxeesdnpootinintstesrseacntdthte

obstacles. in the free

By default space, and

we consider only when construct-

ing an admissible path by joining admissible quasi-segments by their end points we tacitly

presume verifying the When speaking about

non an

oirndteerrsoecf tpinoginotbs sotnacalespabtyhthebpeattwheeonbtsainaenddbty

such a linking. we mean later

or

after such

tinhatthes

sense of a = (0),

cton=tino(u1s),

`length increasing' (if again to appeal

parametrisation to the motivation

=f
from

(t)g0 t 1 of
robot motion

planning A shortest

can path

bbeetwvieeewnesd

as a and

ttraijnecatohroymooftaopryobcolatsws iitshatppaltahyihnagvitnhge

role of time). the minimum

length

among all the paths in this homotopy class.

The problem we consider is to nd any shortest path in a given homotopy class.

We consider below only semi-algebraic curves. When speaking about occurrences of points

we will not distinguish points would happen. The following

naontdatiitosnoscccounrcreenrnciensginpantohtsatbieotnws,eepnrosvidaendd

tthwatillnodeaumsbedig:ufiotyr

a

path and occurrences of X denotes the pre x of

points from

sX;toY

on the

this path occurrence

of

X

on

this

path;

XY will denote the piece of between speci ed occurrences of X and Y on this path,

usually the occurrence of X will be before the occurence of Y .

To estimate the complexity of our algorithms we may consider, without loss of generality, only

paths given by a piecewise simple semi-algebraic representation which will be for briefness

called piecewise representation. As such a representation one may take a list (X; 1; : : : ; m)

constituted of a starting curve with end points Xi

panodintYiXsaatinsdfyisnegmtih-aelgoebbvriaoiucssceotsnditii,oena:cohnseuocfhtsheet

being points

a simple
fX1; Y1g

is equal to X, the other coincides with one of the end point of 2, the other end point of 2

coinsides with an end point of 3 and so on.

One can assume also more e cient mode of piecewise representation of a curve. Namely,

such a curve is represented as a list of systems of algebraic inequalities i, each having the form

h0 = 0; h1 0; : : : ; hk 0, where hj 2 Q(x; y; ), 2 0; 1],

and such that for every 2 0; 1] the system has a unique solution in x; y. In this case

plays the role of the time via the curve.

1.3 Locally Shortest Paths amidst Semi-Algebraic Obstacles in the Plane.
An admissible path ' between s and t is locally shortest if for all small enough " > 0 it has
minimum length among the paths connecting the same points and lying in B('; "). Locally shortest path can be also described as locally non-contractible. It is intuitively clear that locally shortest paths have some canonical form HKSS94]: in the free space it is a rectilinear segment and if its end meets an obstacle the segment must be locally supporting at the point of contact with the obstacle. De ne this observation more precisely. Locally supporting topologically means that no small enough extension of the segment be-

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

5

yond the point of contact intersects the boundary. One can also de ne this property in

Tarski algebra. A rectilinear segment (or a straight line de ned by a vector) is (locally)

supporting to a set U at a point X 2 U \ if for every small enough " > 0 either to the left

of or with

to the right of the ball B(X;

the "2)

intersection of the segment there are no points of U in

"= this

X ? "( + ? ?); X + "(
ball B(X; "2). "To the

+?
left"

?)] and

"to the right" can be easiliy described in algebraic terms (e. g. in terms of the sign of an

appropriate linear function).

A path is locally supporting to a set U at a point X 2 U if every its locally supporting line

at X is also locally supporting to U at this point.

sWeth?een(ospretahkeinbgouanbdoaurtylocawl hsuicphpworitll

without mentioning be equivalent).

the

set

U

we

mean

by

default

the

The (tangent) angle function of a smooth piece of a parametrized path is a function of its

parameter, giving for any point of this piece the (oriented) angle between the tangent vector

at this point and some xed direction. For a junction point of two smooth pieces one can

take as the value of the angle function the corresponding one-side limit (the side is to be

xed to make the value de nite) of this function for any of these pieces.

A quasi-segment is locally convex if its angle function is monotone (not necessarily strictly

monotone). A quasi-segment touching the boundary will be called locally convex with

respect to the boundary if it is locally convex and for any two of its close enough points

belonging to the convex hull of the quasi-segment between these points does not contain

points of the free space. From now on by locally convex we mean it with respect to the

boundary.

We call a quasi-segment of a path monotone (on the path) if for some its small extension (on

the path) its angle function is monotone.

A path is globally convex if it is a part of the boundary of its convex hull. Clearly, when

a quasi-segment of a shortest path touches the obstacles and goes along the boundary, this

piece of boundary must be locally convex, as well as the quasi-segment on the whole.

In the general case a shortest or locally shortest path is not globally convex, even its locally

convex quasi-segment can be not convex because of a too big rotation (imagine a spiral cor-

ridor turning several times around some point). Such a path can change its convexity (i. e.

the type of monotonicity of its angle function), but only via an in ection segment, i. e. a

maximum rectilinear piece of the path such that small enough preceeding and subsequent

pieces of the path are separated by the straight line determined by the segment.

The closure of pieces of the path between two consecutive in ection segments are locally

convex (with respect to the boundary) and monotone on the path.

A path is canonical if it is locally supporting to the obsctacles at all its points (touching ?),

and its intersection with the free space consists of disjoint straight-line open segments, and

its intersection with the obstacles consists of locally convex quasi-segments of the boundary

.

Note that the property of being locally supporting to the obsctacles in the de nition of

canonical path is used only locally, namely, it is essential only for points of linking of the

mentioned quasi-segments, as each of them has this property in its non end points.

Proposition 1 ( HKSS94]) A path is locally shortest i it is canonical.

As it was remarked in HKSS94] every shortest path ' consists of a polynomial number of semi-algebraic quasi-segments such that each of them is either an in ection segment of '

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

6

locally supporting to at its both ends, or a semi-algebraic locally convex quasi-segment

monotone on the path which, in its turn, is constituted of pieces of or of rectilinear

segments between such pieces, the latter being locally supporting to the boundary at both

its ends (imagine going around a circular saw blade as obstacle).

The rst and the last segments of the shortest paths under consideration will be treated as

in ection segments.

Let ' be a shortest path. Its standard alternating representation (or decomposition) is the

following ( nite) sequence D' of quasi-segments: the quasi-segments D'(2k ? 1), k 1, are

qtbhuyeatschio-ensepsgeimeccueetniovtfeo'ifn'beecctowtnioesentnisteutghtmeedseenbetyns dtohsfe'(tr;hiegiashctpheieqncudeaosmif-asDyeg'bm(e2ekenmt?pD1t')y,()2.lekf)t,

k end

1, of

is the monotone D'(2k + 1) and

The alternating representation of canonical path can be, obviously, found in polytime.

1.4 Graph of Locally Shortest Paths.

Locally convex quasi-segments su cient to compose all shortest paths of all homotopy classes

can be represented as As vertices V of the

garagprahpwh eGt,aakse ist

w, ats

done in and all

HKSS94] or in points that are

a dual form as follows. endpoints of rectilinear

segments that are locally supporting to the obstacles at these endpoints, and which interior

lies in the free space. Denote

=e df

n V . Two vertices X and Y of V are connected by

an edge if they are either two endpoints of a locally supporting segment mentioned above

or consitute two endpoints of a locally convex connected component of e. The point

corresponding to a vertex as well as the quasi-segment corresponding to an edge will be

called its realization. We will not distinguish an element of the graph and its realization if

the context permits to identify the meaning.

Thus obtained graph has one shortcoming. Imagine that we have arrived at some vertex X

of this graph following a locally shortest path with the last quasi-segment corresponding to

an edge eZX from some vertex Z. Now we wish to extend the path in all possible admissible

ways by one next quasi-segment represented in the graph. But not all such extensions are

admissible because of a particular linking may loose local convexity. Sure, this property is

veri able in polytime. But one can make this veri cation just once and do not think about it

later. Let k be the degree of a vertex X, and Z1X; : : : ; ZkX be all edges incident to X. Make

k copies of X, denote them X1; : : : ; Xk, and replace the edges Z1X; : : : ; ZkX respectively by

Z1X1; : : : ; ZkXk, thus the edges incident to the former X have been disconnected, but the

realizations of the edges have not changed. Now we connect by zero-edges, i. e. constituted

by segments Xi; Xj], only those vertices which give an admissible canonical linking.

The resulting graph will be of canonical quasi-segments

denoted or, more

by G brie

y=, tGhee?;csa;nton=ica(Vl ;gEra)pha.nd

will

be

called

the

graph

As we do not use lengths of the involved edges the graph can de found in polytime by a

usual RAM HKSS94].

Lemma 1 The graph of canonical quasi-segments can be constructed in time polynomial in
the size of representation of obstacles.

Obviously, every path between s and t in G
proposition 1. And inversely, every canonical

ipsactahnobneitcwaeleannds

thus, and

tlociasllryepsrheosretnetsetddiune

to G.

Thus we have

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

7

Lveermticmesas2

aAndpatthinbetthweegernapsh

and t is canonical
of canonical paths.

(locally

shortest)

i

it is a path between

2 Paths in Homotopy Classes
In this section we consider homotopy class representation used in our algorithmic treatment of homotopy classes.

2.1 Representation of Homotopy Classes.

We speak about paths between s and t that are homotopic in the free space. And to represent

homotopy classes we use ray cuts of the plane GS97] that is, in a way, dual to the classical

representation ST80] which is hard to treat algorithmically. (We do not know whether this

type of representation was explicitly mentioned elsewhere although it appears to be quite

convenient for algorithmic purposes.)

Generators. The plane is supposed to be oriented.

As generators of the fundamental group of co? we take semi-algebraic cuts of the plane by

pairwise disjoint homeomorphic images of rays as described below. Such a ray will be also

called a cut. If not to mention the complexity of representation of cuts we can assume that

each cut has polynomial complexity with respect to the complexity of the obstacles.

Choose in every component obstacle one or more points (using, say GV88]), and launch

from every point one cut such that all the cuts are pairwise disjoint and go to in nity. (In

fact it su ces to demand that cuts are pairwise non intersecting, but such a generality is

not really needed. Another possible generalizaation is to launch several rays from one point,

though being treatable, seems to be useless.) Attribute to each cut an individual letter. The

set F 1 of these letters constitutes a set of generators of a free group. The set of inverses of

letters For w

of F 1 will be denoted by
2 F we denote by cut(w)

F ?1, and the their union the cut corresponding to

by w,

F =df F 1 i. e. cut(

F ?1. ) = cut(

?1) =

for

2 F1, and by start(w) denote the point from where the cut(w) emanates.

If we choose in every component obstacle exactly one point and launch from it exactly one

cut then we speak about a minimal basis, otherwise we speak about an arbitrary basis.

Now one can de ne the homotopy type of a path in the plane as follows. Consider the

consecutive intersections of the path with the cuts. An intersection via a non degenerated

quasi-segment is considered as one intersection (such "pathological" intersection can be easily

avoided by a small displacement of cuts, but we can easily treat the general situation), and

the direction of each intersection in determined by the orientation of the plane. Another

degenerated case is the case of a touch of a cut by the path without intersecting it; in this

cignaotseeesrsitnehcettrhieoenicsslondcoekwinnietsseerdtsheirceetcifootinlolontwhtiohnueggnhwthotehrdeitthboFlue(cthte)m:r oiaffytthchoeenwistothirtduintisetears,esoectgthimoenrewniitss.ewTith?hi1s.asRecqeudutuencecaetnhodef

word as an element of the free group to the incontractible (irreducible) one and denote the

resulting word F ( ) that can be considered as a representation of the homotopy class of .

If F is xed and clear from the context we will omit the subscript F in the just introduced

notations. The empty word over F will be denoted here by 1.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

8

Lemma 3 For any basis F two paths '0 and '0 with the same ends are homotopic i the
irreducible words over F corresponding them are equal: F ('0) = F ('1). For every minimal basis F the mapping F is a bijection between homotopy classes and words over F .

Lemma 3 is obvious as the free group de ned by a minimal basis is isomorphic to the fundamental group of the plane with deleted obstacles, and groups over larger bases are epimorphic to the fundamental group (all cuts except one in every component obstacle are mapped into 1).

Lemma 4
' the word

FboFr('an),y

piecewise semi-algebraic path given as a piecewise simple representation
and thus the word F ('), can be found in time polynomial in the size of

representation of obstacles and in the sizes of representation of the basis and that of the path.

In particular, the edges of the canonical graph can be labeled by the corresponding words in

polytime.

Proof. Let ' be represented by a list (X; 1; : : :; m) of non degenerated simple semi-

algebraic paths. One can determine in polytime the consecutive end points

X1 = X; X2; : : : ; Xm; Xm+1 of the simple paths i, i. e. such that the pair Xi; Xi+1 con-

stitutes the end points of i, 1 i m; passed in this order if to start from X and to

go along '. Indeed, for each i nd the connected components of its intersection with cuts

and the connected components of
among fXigi permits to determine

the the

di erence of i and the set of all cuts. The order order of the found components on the path and thus

to de ne the word over F . Some special attention is demanded by the points Xi if they are

on the cuts.

For the 2

the second subsection

type 1.2),

iotfirseepvreenseenatsaiteirontoocf ocnusrtvreusc,twbitFh('p)arianmpeotleyrtim(em. entioned

at

the

end

of

2.2 Extremity Basis
One type of generators proves to be especially e cient to construct shortest paths. To de ne it we choose some particular coordinate system (x; y). Firstly note that there is a direction for y for which every straight lines parallel to the y-axis has at most one point of where this line is supporting to . All such directions can be described in Tarski algebra, and clearly, this set is not empty, as the number of directions for which contains a straight-line segment parallel to y-axis, is nite (even bounded by a polynomial of N1, N2 and d, see (1), as the number of connected components of some set described by a formula in Tarski algebra of bounded complexity, see subsection 1.1), and the number of other directions with straight lines having two points supporting to the boundary does not exceed the square of the number of maximal locally convex quasi-segments of the boundary ("maximal" means that the segment cannot be extended along the boundary resting locally convex to the boundary). The number of such maximal locally convex quasisegments is also bounded by a polynomial (though niteness su ces). Thus we can choose a coordinate system (x; y) in the plane in such a way that each straight line parallel to the y-axis contains at most one point of where it is supporting to the boundary.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

9

Fs(dRtiiRrne21dc0\(taiol?lin)s=uoicfnhyt0i-p,haoex1iinisntts(etioroifogtrhkivoe.ef Tbtahoaukecenloedbraaesrcrtytagi,celliolenemsteatetrhthraceituyc taabsrreesgtuiani01rn;tgni:n:itwg:e;elfyrao0kcb.mluoCssoeeinttisonhtretuh01gc;eet:op:pg:oor;sianiptt0kihsvaiecnodn1r;os:ntu:ioco:rhn;tshtehkfrao2ntr
cardinal points). Such a set of cuts will be called an extremity basis of the fundamental group. Obviously,

Lemma 5 An extremity basis can be found in time polynomial in the size of representation
of obstacles.

The crucial property of extremity bases is the following one.

Proposition 2 The word W =
shortest (or canonical) path ' is

bF (') over
irreducible.

an

extremity

basis

F

corresponding

to

a

locally

Proof. Suppose that W is reducible. Take any occurrence of a pair of reducible letters, let it
be ?1, hence the path enters the cut from the West. Consider the part of ' determining this occurrence. Denote by X0; X] the segment of clockwise entering/leaving the cut (i. e. ' comes into the cut at X0 goes along up to X and goes out of the cut at X, normally, X = X0) and by Y; Y 0] the segment of counterclockwise entering/leaving the cut . Now we are interested in the part 'XY of ' between these occurrences X and Y . Take any point Z among the most eastern points of 'XY . This point is on the boundary, otherwise 'XY could be shortened. Moreover, 'XY is locally supporting to the boundary at this point because '
nciobosoffoeorcsdtrao?hdenlu1sionc.mtnraiAoiiutbcnesaectssld.,o.innaTbHtntyhredearaandstcceisomcecynt,tseistZo'eaenqnmX.iussYeto,lnhfotaacalntyaldg,lZleZyhb=ersianussicpcdtepReeoaq0rpn(utpeiande)tgnifoodovnfroessrsrowomsRmiotem0he.leceTotv2theeeurrFstc,ib.ciieeaBtnflouitssrstteurotavtnhiheiegqerhcuRtumetl0edinnuwetewii.tohthnToiechdohniusigortopcececohnsuinourtirtmoceecntbahcoeneerf
2

2.3 Constructing a Path in a Homotopy Class Given by a Word in the Fundamental Group
If we are given an arbitrary set of cuts it is not so simple to construct in polytime the shortest path in a given homotopy class represented as a word over this set. Extremity basis is much simpler to treat (see below section 3). But how to transform e ciently a representation over one basis into the representation over another basis? A natural way is to construct any path in the corresponding homotopy class. We show here how to do it in polytime.
Lemma 6 Let a homotopy class be given by a word over an arbitrary basis of cuts, each
being piecewisely represented semi-algebraic curve. A path in this homotopy class be found in time polynomial in the size of representation of obstacles, in the size of the word and in the size of representation of the basis.
Proof. Let F be the alphabet of generators determined by an arbitrary system of cuts. Let W = w1 : : : wn, wi 2 F , be an irreducible word over F determining a homotopy class. We
construct a path ' with (') = W by the procedure described below. Roughly speaking,

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

10

we contract the obstacle components to points, build a path corresponding to W and then

in ate the obstacles back homotopically transforming the just built path. To realize this idea

in polytime, the procedure rstly builds a new, auxiliary system of obstacles representing

this contraction, constructs a path in the homotopy class W by a known polytime procedure,

and then seeks an appropriate homotopy to come back to the initial obstacles. We take two more in nitesimals 2 << 1 << and consider the plane over the

eld R2.

The in nitesimal 1 will be used to "move" the starting ends of cuts into the interior of the

obstacles, and For each cut

02

will such

be used to build an auxiliary system that start( 0) is on the boundary

of ,

obstacles. choose a point

X

in

?

at a

distance 1 from and append to the segment X; 0]. It is possible as 1 << . After

that replace every cut by the band B( ) of width 2 centered at . More precisely, the

band B( ) is a union of all segments s of length 2 with centers on and having the property:

if the center X of s is start( ) then s is orthogonal to , otherwise it is orthogonal to a

straight line locally supporting to at X (the latter line is not unique in a nite number of

points). Denote by c the segment centered at start( ) that is the "bottom" of B( ), it is

orthogonal to at start( ). Take the segment of length 2 2 parallel

B( B( The

))setatotgBbdetisihsteatrnhwceeimth2enftrio,omannedsdtaaburytx(Bibli)at.rhyeTsuhynesitoseenmgmoofefBnodt(bst)aoclvlieeessr.

in all

? . Denote cuts .

to by

cBd(an)dthcerobssainndg

DBCtaehnoe,ednnaoostpttbhpreseuetbcnaityncdvlteethsoriesBeeitptdh,ateasthehpsegpemgsemeneg=dnemtnteton(Wct+tuchut(it)2ws(,wiip)nia;)anittdfc?hhuwets(towihfoi=e)ol]lnsociewfuugwtimpn(iwget=nio)wt,ctauy.1t.,(SwBbuiuu)ci?ihlld1d.aaappapatahtthh

from from
can

sb1e+tcotoonst12??rucaatmmediiddissntt

polytime using appropriate Now consider the original

graphs of obstacles

?ecananondicoarligqiunaasli-csuetgsm. enGtos.ing

from

s

to

t

transform

the path , which in the general case intersects the obstacles, into a semi-algebraic path '

which does not intersect them and such that (') = W. One can imagine that we in ate

the auxiliary obstacles back to the original obstacles and modify making it to go along

the boundary of component obstacles in a proper direction. We will use notations for pieces

of curves introduced in subsection 1.2. Speaking about points here we mean occurrences of

points that can be indicated by a reference to the list de ning the piecewisely represented

semi-algebraic curve under consideration.

oSwbu1sp:tp:a:ocwsleek?ct1oh,nattaki'nZin1gi.sstIcafornkts(?twruk1)c.t<eHdnauvtpihnegtnolewfstokmZisebdouectcnbueerdfroe,rnaecnerdeoawfcheZindge2nSo,teo, rbyt('SinZt)thhe=eccoams(epoZwn)heen=nt

('Z) = W , the path may cross some component obstacles without intersecting any

cut. Let S1 be the rst such an obstacle, see Figure 1. Denote by X1 the rst point of its

intersection with S1. Then look for the consecutive points of of its entering and leaving S1

without intersecting other component obstacles. Denote by Y1 the last point of leaving S1

among X1 and

these points. Y1 divise the

Note that the boundary of S1

pinietcoetwoX1qYu1 adsio-essegnmotenitnst.erAsetclteaasntyoncue to.f

The two points them, denote it

bpyoinqthtas)

(q) = will lie

1 in

otherwise W the domain

does not de between two

ontehearncyuhtsomemotaonpayticnlgasfsrobmecSau1,seancdutt(hweke)n(torranthcee

in this domain will be blocked by S1. Note that q may intersect also cuts emanating from

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

11

Π(W) X1

α1 Y1

S1

X S

β Y

Figure 1: Going around obstacles.

sources not in S1. must leave it and

But no such a cut intersects all these cuts intersecting S1

arXe1Yp1aairnwdisheadviisnjgoionnt.ce

entered

S1

such

a

cut

Replace the piece of between N(o'wZYc1o)n.sider the case of S, i.

X1 e.

and the

Y1 by q. That will give 'Y1. Clearly, ( case when the rst component obstacle

ZY1) = 1 = intersected

by the

after Z last such

is S. point

Denote by X which precedes

the rst point of intersection of points of intersection of this path

wZitthwoitthherScoamndpobnyenYt

obstacles. Again consider two quasi-segments of the boundary S determined by X and Y .

One and only one of this quasi-segments has the property: when going from X along this

quasi-segment the path meets the rst intersection of cut(wk) with the boundary S in

correspondence with wk (that is in the direction of k). Denote this quasi-segment by q.

Now extend 'Z by the segment ZX and then by q. This gives 'Y . One can show that

('Y ) = ( Y ) = w1 : : : wk.

Indeed, the rst intersection of Y with cut(wk) is in the direction wk. Other cuts may

intervene between intersection with cut(wk) only as words equal to 1, otherwise the initial

W would not de ne any homotopy class.

To estimate the complexity notice that the number of perfomed modi cations of the path

does not exceed the number of points of intersection of the path with the obstacles that can

be bounded by a polynomial as required in lemma 6 (e. g. see GV88]).

2

3 Algorithm for the Shortest Path in a Given Homotopy Class.
Before describing an algorithm for constructing the shortest path of a given homotopy class we show that such a path is unique. Moreover, even locally shortest path is unique, and due to proposition 1 the canonical path is unique.

3.1 Uniqueness of Locally Shortest (Canonical) Path.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

12

Proposition 3 There is a unique locally shortest (or canonical) path in a homotopy class.
Thus, the unique shortest path of a homotopy class is the unique canonical path in this class.

Pbertowoefe.nSsupapnodset

that there are two di erent homotopic locally shortest paths '0 and '1 . The both are canonical (Lemma 1) and hence, piecewise semi-algebraic.

Let Z be the last emanating from Z

point along

of their longest common the one-sided tangent to

pre 'Z

x at

Z'Zin=dtfh(e'di)iZre.ctDioennofrtoembys

Rtothte,

ray see

Figure 2. In a neighborhood of Z the curves '0 and '1 lie on the same side of R, the ray

y R

Z ϕΖ

ϕ0 ε1
α1 ϕ1

Z0

(Z0 )

ϕ0

(ϕ0 )

(α2 )

x

ε2 α2

(Z0 = t)

Figure 2: Uniqueness of locally shortest (canonical) path.

itself not excluded. This observation is implied by the canonicity of the both curves. Indeed,

the fact that one of the paths deviates from R means that there is an obctacle at Z, denote

it by S. Suppose without loss of generality that S is to the right of 'Z and, hence to the

right of R. Then no canonical extension of 'Z may go above R because that would mean

a presence of an obstacle also to the left of R at Z. But then 'Z intersects obstacles at Z.

Thus, the both curves '0 and '1 lie on the same side of R.

Let '0 be the rst curve that we meet (locally at Z) going in the clockwise direction from R

around Z, and '1 be the second one. Then '0 must be a rectilinear segment in the free space

in some neighborhood of Z, otherwise the both curves have at Z to the right of them some

toT'oofba0sRk?bteay"0ct.1wleZCao,n;haidZonn0old]as.neutiTnthaeacuschksiuemf'tr(ao1xlms;i1nycti2)tee-<cnrtsoth<eeoecrrtedrsd1ainyt<ahatp<teeassoroabmcalselnteenaldtpcetolcoreioesnxnd.ts-aaDiidnxteeiZnsrnotiitnwtheeehtlsyhicuceohccrlhproxeos-msseapixtatoioixvnsiedZmgidonawieglrsiertrceahetclaiotyolin-nlcciglnoooeosfZaretrd;dhZisinees0xag]a.ttmexenieessn,qitousneoaesfl

IFfigZu0re6=2.t

Add 1 then

to '0

2 in nitely close to

second case. If Z0 =

the alphabet of cuts.
gZto0easwdifdtrhonmoyt-chZoi0nogred.itihnIneartaebneyeqlocuwaaslext-oax(?'is"Z2o)irn1atbwhoielvlebriestt.acApasrdeed,

to the cuts and to +"2 x of ('1),

a cut in the where

is considered over the extended alphabet.

In the case Z0 = t the word
('1).

('0) contain neither

1 nor

?1 1, and, hence, di ers from

In the case when '0 1, and thus, ('0)

goes from
6= ('1).

Z0 below Similar in

x-axis the letter the case when '0

2 appears in goes from Z0

('0) just before above x-axis. A

contradiction.

2

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

13

3.2 Algorithm for Canonical Path.
Thus, in order to nd the shortest path of a given homotopy class it su ces to nd the canonical path of this class. We describe an algorithm that constructs such a path when the homotopy class is represented as the word in an extremity basis. This supposition does not diminish the generality. Indeed, if the class is represented by a piecewise semi-algebraic path, we can compute its representation over an extremity basis in polytime (Lemma 4), and an extremity basis itself can be found in polytime (Lemma 5). If the class is represented as a word over an arbitrary basis of cuts then one can found in polytime a piecewise semi-algebraic path in this class (Lemma 6) and again reduce the problem to the case when the class is given as a word over an extremity basis. The algorithm ShPthHomCl that constructs the shortest path is given by Figure 3. This algorithm transforms a word over an extremity basis into the canonical path corresponding to it, is to gradually build all paths corresponding to pre xes of the word advancing via the graph of canonical paths. The uniqueness of the canonical path and the irreducibility of words (see proposition 2) appearing while advancing assures that the number of paths under treatment will not go beyond the product of the number of vertices of the graph of canonical paths and the length of the word. Indeed, if two di erent canonical paths meet at the same vertex their words must be di erent otherwise the uniqueness would be violated (see proposition 3). In the description of the algorithm the following notations for paths p and q are used:
p? and p+ are respectively the rst and the last vertex (and the corresponding points) of the path p;
conc(p; q) is the concatenation of the paths p and q if p+ = q?; LastQSeg(q) is the last edge and the corresponding quasi-segment of the path q.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

14

ShPthHomCl(F; H):

comment H is an irreducible word over an extremity basis F. The

IfTcaonlohgirmteoairalemilltnihsdeamn2tptioouEinPsne:tascstohtsmhsepaigsunrtdaaeptsheotFGf(op=f)a;ct(haVns;oaEnriP)ecaaolftxhecpsdaan.=thoensfniscduanglcd; oqeumr acmsoi-nessentgtrm;ucetniotsn.

that will nally contain the resulting shortest path if it exists.
end comment;

1:

while0

sP

aths and

its

non
do

empty

and

does

not

contain

a

path

between

WordExtension:

2: 3: 4:

forEPaaxlltt0hp sp:=:2=fPpPgaa;tthhssdnofpg;

5: 6: 7: 8: 9: 10:

whfoilrEfeoa1xrltilftEah10plexlq:q2n=t02p=qE6=udEfaxcx;stoitp-ndpsnceod(gfqomq;ge;n) tis

c6=anLonaisctaSl eagn(dq)bo(fqG0)

incident is a pre

to q+ do
x of H

11:

iefnPednaedwtnhehdfsnoi=lerdwena0eh;ldf;lnoi0tlierdfefhnoa11erldilnfa10(lirlpf21e) t=urn(q"0n) otehlpseaenthPEafoxtrhtpsH::="= EPxattphs

fq0g fq0g

else return any path between s and t from the set Paths end if

Figure 3: Algorithm: Shortest Path in a Homotopy Class.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

15

Lemma 7 Given an extremity basis, for every irreducible word H over this basis the algo-
rithm ShPthHomCl veri es whether H de nes a homotopy class and if so, nds the shortest
path in this homotopy class in time polynomial in the size of representation of obstacles and
in the length of H.

Proof. If H de nes some homotopy class then the shortest path with (') = H exists and is

unique due to proposition 3. And it is canonical (proposition 1). All the canonical paths are

rsteohpmereeaslhgeonormtietodhtmoinpyiGs c,cloaarsnrsdeicitnvtahesresirteelylio,soeakvseprafyotrhpaa'ltlhipnianGthGsbeiisntwcGeaennsotnasirctaianlng(dLaettmswmiatahn2d).(c'To)rhru=ess,pHoH.nddHienegnncteeos,

pre xes of H (it su ces to consider just pre xes of H due to proposition 2).

Spoatihtsreesmtsatnoateisntgimfraotme thse

complexity of the algorithm. The and corresponding to pre xes of

algorithm analyzes all canonical H. If 2 such paths come to a

same vertex their words must be di erent due to proposition 3 and lemma 3. Hence the

number of paths neither in the set P aths nor in the set Extp does not exceed the product

of the number of the vertices of G and the length of H. And the same bound is valid for the

number of possibles sets Extp as p originates from P aths.

At any step of the algorithm the length of a current pre x either augments or does not

change, if the added line 9 the algorithms

veedrgi eeosfthGatrebp(rqe0s)einstas

the pre

empty word, see x of H, and thus,

proposition veri es that

2 (note that in the augmented

word has no contractions). The latter happens consecutively at most jEj times (where E

is the set of edges of canonical graph, see Figure 3), since otherwise we get a loop in the

canonical path which provides the empty word, hence it is contractible (cf. Lemma 3), and

we can delete the loop, that condradicts proposition 3. Therefore the number of steps of the

algorithm does not exceed jHj jEj.

2

We summarize the proved above in the following main result of the paper.

Theorem The problem of constructing the shortest path in a given homotopy class rep-
resented either as a word over a piecewise semi-algebraic basis of cuts or as a piecewise semi-algebraic path is solvable in time polynomial in the size of representation of obstacles and in the size of representation of the homotopy class.

Acknowledgements. The second auther is thankful to the Departments of Computer Sci-
ence and of Mathematics of Pennsylvania State University for the hospitability during his stay there in February 1997.
References
AM88] M. E. Alonso and Raimondo M. The computation of the topology of a planar semialgebraic set. Rend. Sem. Mat. Univers. Politecn. Torino, 46(3):327{342, 1988.
BCR87] J. Bochnak, M. Coste, and M.-F. Roy. Geometrie algebrique reelle. SpringerVerlag, 1987.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

16

BSS89] L. Blum, M. Shub, and S. Smale. On a theory of computation and complexity over real numbers: NP-completeness, recursive functions and universal machines. Bull. Amer. Math. Soc., 1:1{46, 1989.
Can88] J. F. Canny. The Complexity of Robot Motion Planning. ACM Doctoral Dissertation Awards. The MIT Press, 1988.
CGV92] J. Canny, D. Grigoriev, and N. N. Vorobjov, Jr. Finding connected components of a semialgebraic set in subexponential time. Appl. Algebra in Engineering, Communication and Computing, 2:217{238, 1992.
CR87] J. Canny and J. Reif. New lower bound technique for robot motion planning problemms. In Proc. 28th Annu. IEEE Symp. on Foundations of Comput. Sci., pages 49{60, 1987.
CSY94] J. Choi, J. Sellen, and C.-K. Yap. Approximate Euclidean shortest path in 3space. In Proc. 10th ACM Symp. on Computational Geometry, pages 41{48, 1994.
GHR+90] D. Yu. Grigoriev, J. Heintz, M.-F. Roy, Solerno, and N. N. Vorobjov, Jr. Comptage des composantes connexes d'un ensemble semi-algebrique en temps simplement exponentiel. C. R. Acad. Sci. Paris, 311, Ser. 1:879{882, 1990.
Gri88] D. Yu. Grigoriev. Complexity of deciding Tarski algebra. J. Symb. Comput., 5:65{108, 1988.
GS97] D. Grigoriev and A. Slissenko. Computing minimum-link path in a homotopy class amidst semi-algebraic obstacles in the plane. In T. Mora and H. Mattson, editors, Proc. of the 12th Intern. Symp., AAECC'12, pages 114{129. Springer Verlag, 1997. Lect. Notes in Comput. Sci, vol. 1255.
GV88] D. Yu. Grigoriev and N. N. Vorobjov. Solving systems of polynomial inequalities in subexponential time. J. Symb. Comput., 5:37{64, 1988.
GV92] D. Yu. Grigoriev and N. N. Vorobjov. Counting connected components of a semialgebraic set in subexponential time. Computational Complexity, 2(2):133{184, 1992.
HKSS94] J. Heintz, T. Krick, A. Slissenko, and P. Solerno. Search for shortest path around semialgebraic obstacles in the plane. J. Math. Sciences, 70(4):1944{1949, 1994. Translation into English of the paper published in Zapiski Nauchn. Semin. LOMI, vol. 192(1991), p. 163{173.
HRS90] J. Heintz, M.-F. Roy, and P. Solerno. Sur la complexite du principe de TarskiSeidenberg. Bull. Soc. Math. de France, 118:101{126, 1990.
HRS94] J. Heintz, M.-F. Roy, and P. Solerno. Description of the connected components of a semi-algebraic set in single exponential time. Discrete and Computational Geometry, 11:121{140, 1994.

D. Grigoriev, A. Slissenko. Shortest Paths in a Homotopy Class...

Version of November 27, 1997

17

HS94] Lat91] MS95]
Pap85] Pap94] Ren92] SS90]
ST80]

J. Hershberger and J. Snoeyink. Computing minimum length paths of a given homotopy class. Computational Geometry, 4:63{97, 1994. J.-C. Latombe. Robot Motion Planning. Kluwer Academic Publishers, 1991. J. S. B. Mitchell and Suri S. A survey on computational geometry, volume 7 of Hanbooks in Operations Research and Management Sciences, chapter 7, pages 425{479. Elsevier Science B. V., 1995. C. H. Papadimitriou. An algorithm for shortest-path motion in three dimensions. Inform. Process. Lett., 20:259{263, 1985. C. H. Papadimitriou. Computational complexity. Addison-Wesley, 1994. J. Renegar. On the computational complexity and geometry of the rst-order theory of the reals. parts 1{3. J. Symb. Comput., 13(3):255{352, 1992. J. T. Schwartz and M. Sharir. Algorithmic motion planning in robotics. In J. van Leeuwen, editor, Handbook of Theoretical Computer Science. Vol. A, pages 391{ 430. Elsevier Science Publishers, B. V., 1990. H. Seifert and W. Threlefall. A Textbook of Topology. Academic Press, 1980.

