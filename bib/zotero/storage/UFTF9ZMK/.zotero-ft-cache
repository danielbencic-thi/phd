Original Article
Unmanned aerial vehicle trajectory planning by an integrated algorithm in a complex obstacle environment
Siyu Zhang1, Jianqiao Yu1, Yuesong Mei1, Huadong Sun1 and Yongbo Du2

Proc IMechE Part G: J Aerospace Engineering 2017, Vol. 231(11) 2048–2067 ! IMechE 2016 Reprints and permissions: sagepub.co.uk/journalsPermissions.nav DOI: 10.1177/0954410016662058 journals.sagepub.com/home/pig

Abstract Both the artificial potential field method and direct method for the optimal control problem have shortcomings in terms of effectiveness and computational complexity for the trajectory-planning problem. This paper proposes an integrated algorithm combining the artificial potential field method and direct method for planning in a complex obstacle-rich environment. More realistic unmanned aerial vehicle dynamics equations, which are rarely applied in the traditional artificial potential field method, are considered in this paper. Furthermore, an additional control force is introduced to transcribe the artificial potential field model into an optimal control problem, and the equality/inequality constraints on the description of the shape of the obstacles are substituted by the repulsive force originating from all the obstacles. The Legendre pseudospectral method and virtual motion camouflage are both utilized to solve the modified optimal control problem for comparison purposes. The algorithm presented in this paper improves the performance of solving the trajectory-planning problem in an obstacle-rich environment. In particular, the algorithm is suitable for addressing some conditions that cannot be considered by the traditional artificial potential field method or direct method individually, such as local extreme value points and a large numbers of constraints. Two simulation examples, a single cube-shaped obstacle and a different-shaped obstacle-rich environment, are solved to demonstrate the capabilities and performance of the proposed algorithm.

Keywords Unmanned aerial vehicle, trajectory planning, complex environment, obstacle-rich, integrated algorithm
Date received: 15 June 2015; accepted: 29 June 2016

Introduction
Nonlinear trajectory planning for unmanned aerial vehicles (UAVs) has become an increasingly attractive ﬁeld of study in recent years. To date, researchers have not been able to obtain an optimal trajectory from a starting point to a target point only. Instead, the limitations of the vehicle’s performance under speciﬁc constraints are considered, such as an obstaclerich environment,1 hostile threats,2 poor weather,3 and constrained airspace.4 These complex conditions pose severe challenges for trajectory planning, and many approaches have been investigated for solving these problems. These approaches can be broadly categorized into the following three classes: (1) mathematical methods, (2) heuristic approaches, and (3) maneuver automation.
Category 1 methods include optimal control theory, dynamic planning, integer linear programming, and some graph search algorithms. Optimal control theory can be further divided into two subcategories: (1) an indirect method based on Pontryagin’s

minimum principle and (2) a direct method based on state and control variable discretization. The indirect method is extremely sensitive to the initial costate, and it is often diﬃcult to obtain appropriate estimates of the costate values because of their lack of physical meaning. By contrast, the direct method is advantageous in that the transversality conditions are no longer necessary and constraints can be easily incorporated. Reza and Ehsan5 obtained realistic and feasible trajectories by discretizing the control variables and utilizing cubic splines to create a smooth control input. In addition, there is a class of methods, named pseudospectral methods, that is gaining widespread adoption such as in Fahroo and Ross,6
1School of Aerospace Engineering, Beijing Institute of Technology, Beijing 100081, PR China 2Hainan Military Representative Office, Hainan 570206, PR China
Corresponding author: Yuesong Mei, School of Aerospace Engineering, Beijing Institute of Technology, 5 South Zhongguancun Street, Beijing 100081, PR China. Email: mys001@bit.edu.cn

Zhang et al.
Jackiewicz and Welfert,7 and Geoﬀrey and Anil.8 The pseudospectral methods can accurately and eﬃciently address some typical optimal control problems, such as the LQR problem,9 launch vehicle problem,10 orbit rendezvous problem,11 and UAV terrain path generation problem.12 In the study by Paul,12 the Legendre pseudospectral method (LPM) is utilized to solve the terrain-following problem, and the constraints generated by the terrain are described through the interpolation method. In Rezaee,13 the obstacle constraints are described by the p-norm expression, then the trajectory planning problem can be solved by the LPM. Although the trajectory results can be obtained, the constraints of the obstacle model are approximated. The p-norm method may be not competent to the complex obstacle.13 In most of the literature about trajectory planning by using optimal control methods, there is a common point that the obstacles must be described by the expression mathematically or approximately, then the trajectory planning problem with obstacle avoidance can be solved by the optimal control methods directly. However, the mathematical expression is diﬃcult to obtain for the complex obstacle. Furthermore, even assuming the obstacle can be described approximately, the pseudospectral methods are powerless when the dimensionality of the problem is too large for real-time applications. The complex obstacle constraints cannot be solved by the optimization algorithm since a large number of discretization nodes lead to the exponential growth of the number of equality/inequality constraints.
Category 2 methods include diﬀerent heuristic methods, such as the genetic algorithm, particle swarm optimization, ant colony optimization, and artiﬁcial potential ﬁeld method. The potential ﬁeld method was ﬁrst used by Khatib for manipulator and mobile robot path planning in the 1980s.14 The main concept originates from the attractive and repulsive rules of the electric ﬁeld in physics. In the trajectory-planning problem, hypothetically, the attractive ﬁeld is induced by the target, and the repulsive ﬁeld is induced by the threats and obstacles. The path planning can be completed based on the composition of the potential ﬁelds. This method is advantageous in terms of computational eﬃciency, as the feasible trajectory is obtained by computing the gradient of the potential ﬁeld function directly. However, in practice, the shortcomings are also apparent. (1) Based on the original principle of the APF method, the UAV may be forced to pull into a local extreme value point, which leads to planning failure. The methods to solve this problem can be divided into two categories. The ﬁrst category is the harmonic potential function method.15–18 The harmonic potential function method can solve the local extreme point by the mathematical proofs; however, there still exists some problems. The choice of the parameters for harmonic potential function is more intractable, and this method may consume more time on the trajectory planning because

2049
of the shielding eﬀect.19 The other category is named random motion method by introducing the concept of ‘‘escape velocity’’.20,21 The escape velocity can overcome the problem by acting as a random velocity on the UAV when it is trapped in the local extreme points. However, there is no principle that determines how to add the reasonable random velocity theoretically. Furthermore, it may be not appropriate when the trajectory has the requirement of smoothness. Since the smoothness is necessary for UAV ﬂying, this method may by invalid. (2) The APF method transforms the complexity of solving the optimal control problem into building a suitable ﬁeld function using the gradient concept, whereas the parameters of the potential ﬁelds typically lack practical meaning. Meanwhile, the traditional APF method is heavily dependent on the parameters of the potential function, and inappropriate parameters may result in the UAV ﬂying without optimality. Thus, a reasonable but simple ﬁeld function is diﬃcult to build to meet this complex situation. (3) The UAV dynamics are ignored because of the intrinsic limitations of the APF method. The majority of studies focus on 2D horizontal plane planning or relatively simple 3D motion planning.13,22,23 The complex 3D situation is seldom considered. For example, the 3D model for APF method is applied in Charifa and Bikdash,19 and it presents two strategies, which include ﬂying in a constant altitude and ascending/descending ﬂying. This means that some state variables are constant in the diﬀerent scenes, and the model is no longer a complete 3D scenario. Furthermore, the velocity of the UAV is constant in a large amount of related work, and the real dynamic constraints cannot be adequately considered for the APF method. Therefore, it is a meaningful problem that applies the more realistic UAV model into the APF method.
To alleviate the heavy computational cost issue in trajectory planning, some maneuver automations are introduced to the optimization algorithm to reduce the problem’s dimensionality in category 3. For example, Bats typically use a constant absolute target direction (CATD) to pursue moving prey.24 Ants can determine velocities according to the headmost ant based on the local pursuit strategy.25 The concept of the virtual motion camouﬂage (VMC) method, which was developed in the study by Xu and Gareth,26–28 originates from the phenomenon of the male hoverﬂy ﬂying on a path connecting it to the female hoverﬂy. The main concepts of these strategies are coincident, obtaining a carefully selected or iteratively reﬁned subspace to reduce the search space size. The VMC method has been utilized to address the one degree-of-freedom linear problem, Breakwell problem, UAV-chasing problem, three-stage orbital insertion problem, robot minimum time collision avoidance trajectory problem, and spacecraft formation ﬂying problem. The results show that the VMC method can reduce the computational complexity and obtain a convergent solution more tractably

2050
compared with the pseudospectral method. In Xu and Gareth,27 the VMC method is applied to solve the trajectory planning problem for 2D circle-shaped obstacle. In Gu et al.,29 the VMC method is utilized to solve the cooperative trajectory planning with obstacle avoidance. The obstacles are described by the p-norm method similarly. Through the simulations, the cube prism obstacle is not approximated very accurately, and the more complex-shaped obstacles are not involved in this reference. Based on a large amount of relative literatures, few simulations have been implemented to illustrate that the VMC method is qualiﬁed to solve a system with a large number of irregular obstacles in 3D.
In order to overcome the above-mentioned problems, an integrated algorithm combining the APF method with the direct method is presented to solve the irregular obstacle-rich trajectory-planning problem in this paper. In addition to the attractive ﬁeld and repulsive ﬁeld induced by the target and obstacles, an additional control force acting on the UAV is introduced to the potential ﬁeld method. The motion of the UAV is no longer aﬀected solely by the target and obstacles, and the additional control force can be optimized to inﬂuence the UAV’s motion. Thus, the choice of ﬁeld parameters may be not crucial compared to in the traditional artiﬁcial potential ﬁeld method since the optimality can be ensured by the additional control force and optimization algorithm. In addition, the additional control force can overcome the local extreme points when the attractive force oﬀsets the repulsive force acting on the UAV. An optimal control problem that describes the trajectory-planning process is built based on this force. The rich irregular obstacles are no longer expressed by equality/inequality constraints (the two types of constraint are referred to simply as constraints in the following parts of this paper) as in the typical optimal control problem but rather by the ﬁeld function. Then, the additional control force is regarded as the optimal variable, and both the pseudospectral method and VMC method are utilized to solve the optimal control problem for comparison purposes. Compared with our previous research in Chen et al.,30 the optimal control problem in this paper is described as a continuous problem, and the UAV motion model applied in the APF method is more realistic. Furthermore, the optimal problem in Chen et al.30 is solved by discrete-time Ricatti equations, which can only ensure the optimality in one iteration step, whereas the algorithm in this paper can obtain a suboptimal solution in the global sense of the planning by the optimal control problem solution.
The proposed algorithm would be able to improve upon the performance of the individual APF method and optimal control method. It can address some conditions that the two traditional methods cannot handle. For the APF method, the local extreme value point problem that is well known for its diﬃculty and the

Proc IMechE Part G: J Aerospace Engineering 231(11)
more realistic UAV model problem are ameliorated. In the meantime, the problem caused by the excessive number of constraints, especially with irregular obstacles of a complex shapes, can be eliminated by introducing the concept of APF method into the optimal control method. In ‘‘Analysis of the diﬃculty in obstacle description by using the above two methods’’ section, we demonstrate that although the optimal control method cannot solve the constraints introduced by the complex shape of the obstacles directly, the proposed algorithm is eﬀective.
The remainder of this paper is organized as follows. In the following section, the UAV model used in the integrated algorithm and the basic principles of the APF method are brieﬂy presented. This section is followed by section III, in which the formulation of the pseudospectral and VMC methods is presented. Furthermore, some disadvantages of these two methods for the obstacle-rich model are presented. In section IV, the integrated APF and optimal control theory algorithm is proposed, and the detailed solution procedure is derived. The simulations and some analysis are provided in section V, and the conclusions in section VI.
Principles of the APF method
The APF method has been applied in a large number of studies. In general, there are three primary diﬀerences between them, namely, ﬁeld functions, the UAV model, and the obstacle model. In the aspect of the ﬁeld form, the attractive ﬁeld function presented in Sivaranjinni et al.14 and the repulsive ﬁeld function shown in Chen et al.30 are applied to accomplish the trajectory planning in this paper. In most papers, the linear particle dynamics equations are introduced to simplify the algorithm.30,31 In Espen and Raymond,32 a motion model in the body frame is presented, and the velocity and angular rate constraints are nonholonomic. This model can describe the UAV motion more realistically and it is updated by some forces applicable to the APF method. The model is improved in this paper, which transforms the coordinate frame to conveniently derive the presented algorithm. Furthermore, the model of complex and entity obstacles makes the planning intractable for the traditional optimal control problem solution, as will be presented in the subsequent section in detail.
Artificial potential field approach
This subsection provides a brief description of the principle of the APF method. The main concept of the APF method is to ﬁll the UAV motion space with an artiﬁcial potential ﬁeld in which the UAV is attracted by the target and repulsed by all obstacles. The APF method attempts to optimize the path by calculating the gradient of the potential ﬁeld. However, diﬀerent forms and parameters of the ﬁeld function may lead to diﬀerent paths, so the ﬁeld function is crucial for APF, and an

Zhang et al.

appropriate ﬁeld function is necessary to ensure that the planning proceeds successfully. Our previous research33
demonstrated that the APF method possesses the fol-
lowing properties:

Properties 1: The potential function is (at least locally) smooth. Properties 2: The artiﬁcial potential ﬁelds are additive for arbitrary artiﬁcial potential ﬁelds.

Let q ¼ (x, y, z) denotes the current UAV position point in the trajectory planning space. Point p denotes the eﬀective point for a particle point target, which is its position, and for an obstacle, which is the shortest point on the surface between the obstacle and UAV. The eﬀective point varies in the trajectory planning process for each obstacle.
The choice of the attractive ﬁeld function is a standard parabola that increases quadratically with the distance between the target and UAV

UattðqÞ

¼

1 2

kad2ðqÞ

ð1Þ

where d ¼ kq À ptargetk. Then, the attractive force is derived by calculating the negative gradient of the attractive potential ﬁeld function.

FattðqÞ ¼ ÀrUattðqÞ ¼ Àkaðq À ptargetÞ

ð2Þ

The repulsive potential ﬁeld increases when the UAV approaches the obstacle and has a decreasing inﬂuence when the UAV is far away. In this paper, the form of the repulsive potential ﬁeld function is

( "eÀlkqÀpik,
UrepðqiÞ ¼ 0,

qq

À À

ppii44dd00

ð3Þ

where " and l are parameters that inﬂuence the form and magnitude of the ﬁeld and subscript i denotes the ith obstacle. ", l, and d0 have an integrated eﬀect on the performance of the avoidance of the repulsive force. The principle of choosing these parameters is that the UAV’s speed reduces to a minimum value at a distance that is less than d0 when UAV approaches the obstacle at its maximum speed. Then, the negative gradient of the repulsive ﬁeld is

FrepiðqÞ ¼ ÀrUrepiðqÞ

¼

(

"l

qÀpi
kqÀpik

eÀlkqÀpik,

0,

q À pi4d0 q À pi 4 d0

ð4Þ

The resultant force action on the UAV is then derived

!

1

XN

Â

Ã

a¼ m

Fatt þ Frep À 0
i¼1

0

mg

ð5Þ

2051

where a is the acceleration vector in the inertial frame. The UAV is subjected to a constant force [0 0 mg] that oﬀsets the force of gravity in equation (5), and this can ensure that the UAV will not crash into the ground as a result of the force of gravity. The schematic graph of the APF method for trajectory planning is shown in Figure 1.

Aircraft dynamics model
A body frame can be deﬁned by the xb, yb, and zb axes. xb is aligned with the velocity vector, yb is aligned with the left wing of the UAV, and zb completes the right-handed orthogonal reference frame. Assuming that the velocity vector is only along the xb axis, then the UAV motion model can be described as

x_ ¼ V cos  cos v

y_ ¼ V cos  sin v

z_ ¼ V sin 

V_ ¼ T À DUAV À g sin 

ð6Þ

m

_

¼

1 V

ða2

À

g

cos

Þ

_ v

¼

V

a3 cos



where x, y, and z are the position coordinates in the inertial frame; V is the speed (magnitude of velocity vector);  is the ﬂight path angle; v is the heading angle; m is the mass of the UAV; g is the gravitational acceleration; T is the thrust force driven by the engine; DUAV is the damping force caused by the atmosphere; a2 is the vertical component of the normal acceleration, and a3 is the horizontal component of the normal acceleration. Assuming a1 ¼ T/m, then a1, a2, and a3 can be regarded as the optimal variables that propel the UAV reachable to the entire motion space.

obstacle1

target

acceleraƟon aƩracƟve force

direcƟon

obstacle2

repulsive force induced by obstacle2

UAV
repulsive force induced by obstacle1

resultant repulsive force

Figure 1. Schematic graph of APF method. UAV: unmanned aerial vehicle.

2052

The damping force is signiﬁcant in not only the real physical UAV motion but also this potential ﬁeld method. Tobias et al.34 noted that the vehicle will be accelerating at all times under the attractive force and will reach the UAV’s performance limitations, including its velocity performance and acceleration performance. Furthermore, the parameters of the repulsive ﬁeld function may be unreasonable or even disabled for a large variation range of the velocity. Thus, a damping force DUAV is introduced to avoid the increasing velocity, and DUAV is derived as

DUAV ¼ CdV

ð7Þ

where Cd is the damping force coeﬃcient. Because the virtual attractive and repulsive forces are generated by the target and obstacles, a1, a2, and a3 should be transformed into the inertial frame. The transformation of the acceleration vector from the body frame to the inertial frame can be achieved by employing the rotation matrix L

23

23

a1

ax

64 a2 75 ¼ L  a ¼ L  64 ay 75

a3

2

az

cos  cos v cos  sin v

¼ 64 À sin v

cos v

À sin  cos v À sin  sin v

32 3 sin  ax
0 7564 ay 75 cos  az
ð8Þ

where a ¼ [ax, ay, az] is the acceleration vector in the inertial frame derived by the resultant force composed of the attractive and repulsive ﬁelds.
In this paper, a novel integrated algorithm based on the traditional APF method is presented, and an additional control force is introduced to transform the APF method into the optimal control problem framework. The control force is regarded as a control input adding on the resultant force of the UAV. Then, formulation (5) can be modiﬁed as

!

1

XN

Â

Ã

a¼ m

Fatt þ Frep À 0
i¼1

0

mg þ uadd

ð9Þ

where uadd ¼ [Uax, Uay, Uaz] deﬁned in the inertia frame denotes the control variable in trajectory planning, which ensures that the UAV is completely controllable. By substituting formulations (7), (8), and (9) into formulation (6), the ﬁnal motion state formulation of the UAV that is applicable to the algorithm is derived as

x_ ¼ f ðx, uadd, tÞ

ð10Þ

where x ¼ [x, y, z, V, , ] denotes the motion state variables in this paper; f is the dynamic equations of the UAV.

Proc IMechE Part G: J Aerospace Engineering 231(11)
Obstacle model
To facilitate the expression, the obstacles are convex, although this does not mean that concave obstacles cannot be processed in the following integrated algorithm. This is because the relationship between the obstacles and the UAV in this algorithm is represented by the distances between them instead of the equations of the obstacles’ shapes in the optimal control algorithms. Thus, the trajectory planning can be completed as long as the distance can be calculated. A concave obstacle can be divided into some obstacles of convex shape, and the shortest distance between the surface of the obstacle and the UAV can be calculated. The shapes and size of the obstacles in this paper will be shown in detail in the simulation section, and the algorithm of calculating the shortest distance will also be presented in the same section.

Pseudospectral method and virtual motion camouflage
Both the pseudospectral and VMC methods are developed to solve the optimal control problem in this paper through the comparison with the results. They exhibit diﬀerent advantages in problem solving.

Pseudospectral method
To date, countless studies on developing the theories and applications of the pseudospectral method in various ﬁelds have been implemented. The main concept is transcribing the optimal control problem to a nonlinear programming problem by discretizing the control and state variables onto a series of nodes. There are three diﬀerent pseudospectral methods, which are distinguished by the nodes derived from diﬀerent forms of the Legendre polynomial. In this paper, the Legendre–Gauss–Lobatto (LGL) pseudospectral method is used as an example, but the other two methods can also be applied in the same manner.
The detailed derivation process for solving the optimal control problem by the LPM is not the keynote of this paper, and it can be found in Xu and Gareth.35 For brevity, only the original form of the optimal control problem and the ﬁnal form derived by the pseudospectral method are shown

Z tf

min J ¼ ðxf, uf, tf Þ þ Lðx, u, tÞdt

8 >>>>><

x_ ¼ f ðx, u, tÞ C0ðx0, u0, t0Þ

t0
¼0

s:t:

>>>>>:

Cf ðxf, uf, tf Þ Cl4CtðxðtÞ,

¼0 uðtÞ,

tÞ4Cu

,

t0 5 t 5 tf

ul4uðtÞ4uu

ð11Þ

Zhang et al.

where J is the cost function;  is the terminal performance; L is the integral performance; x0 and xf are the initial and terminal state variable vectors, respectively; u is the control variable vector; f is the state diﬀerential equation; C0 and Cf are the initial and terminal state constraints, respectively; Ct is the process constraints; and Cl and Cu are the lower and upper boundaries of the process constraints, respectively. By utilizing the LPM, equation (11) could be transformed into

min J ¼ ðxðMÞ, uðMÞ, MÞ

þ

tf

À 2

t0

X M

wkLðxk,

uk,

kÞ

8 k¼0

>>>>>>>><

PM

DikxðkÞ

¼

tf Àt0 2

k¼0

C0ðxð0Þ, uð0Þ, 0Þ

f ðxðk ¼0

Þ,

uðk

Þ,

k

Þ

s:t:

>>>>>>>>:

Cf ðxðMÞ, uðMÞ, MÞ ¼ 0 Cl4CtðxðkÞ, uðkÞ, kÞ4Cu

,

ul4uðkÞ4uu

ð12Þ

k ¼ 0, 1, 2, . . . , M

where D is the diﬀerential matrix, which can be calculated oﬄine by the Lagrange polynomials of order M; wk is the Gauss weight; and k, (k ¼ 0, 1,. . ., M) are the LGL points lying in the interval [À 1, 1], which are transformed from the discretization of t 2 [t0, tf].
Formulation (12) is a typical nonlinear parameter programming problem and it can be solved by many algorithms, such as the genetic algorithm (GA) or sequential quadratic programming (SQP). It is notable that the number of constraints is determined by the number of nodes and the complexity of the obstacles’ shapes in the trajectory planning. Thus, the number of constraints may be catastrophic in an obstacle-rich environment. In addition, the initial estimates of the parameter optimization problem may be intractable.

Virtual motion camouflage
The VMC method was developed in various studies24–26,35,36 to reduce the complexity of solving the optimal control problem. By using the VMC method, the state and control variables can be represented by the path control parameters, the virtual prey motion, the reference point, and their corresponding derivatives. Then, the optimal control problem can be solved in a selected subspace with fewer dimensions. The brief principle of the VMC method is as follows.
In accordance with Assumption 1 in Xu and Gareth,27 the state variables in the optimal control problem can be divided into two parts, the ‘‘position’’ state xa and the corresponding ‘‘state rate’’ xsr. Among them, the ‘‘state rate’’ xsr can be solved by the function with respect to xa, the derivative of xa, and the time variable t according to Assumption 2 in the same reference. Then, the ‘‘position’’ state xa is

2053

conﬁned by the virtual prey motion vector xp and the reference point position vector xref as follows.

xa ¼ xref þ #ðxp À xrefÞ

ð13Þ

where #(t) is the path control parameter (PCP) deﬁned originally in Xu.26 The derivatives of the
‘‘position’’ state xa can be obtained through the following two formulations

x_a ¼ x_ref þ #_ðxp À xrefÞ þ #ðx_p À x_refÞ x€a ¼ x€ref þ #€ðxp À xrefÞ þ #ðx€p À x€refÞ þ 2#_ðx_p À x_refÞ
ð14Þ

Then, given xref and xp, the optimal control problem described in equation (11) can be rewritten as

Z tf min J ¼ ð#, #_, . . . , tf Þ þ Lð#, #_, . . . , tÞdt

8

t0

>< C0ð#, #_, . . . , t0Þ ¼ 0

s:t:

>:

C0ð#, #_, . . Cl4Ctð#,

., #_,

tf Þ ...

¼0 , tÞ4Cu

,

t0 5 t 5 tf

ð15Þ

where the dynamic diﬀerential equations x_ ¼ f(x, u) have been considered when calculating xsr and u base on the above Assumption 2. To address formulation (15) through nonlinear programming algorithm, the PCP #(t) should be discretized. Let #0 ¼ #(t0), and #M ¼ #(tf), the PCP #(t) is approximated using the Lagrange interpolation polynomials, with PCP nodes #k, k ¼ 0,. . ., M. Denote the PCP vector by vp ¼ [#0, #1,. . ., #M]; then, formulation (15) can be discretized as

min

J

¼

ðvp, tf Þ þ

tf

À 2

t0

X M

wk

LðvpÞ

8

k¼0

>< C0ðvp, t0Þ ¼ 0

ð16Þ

s:t:

>:

Cf ðvp, tf Þ ¼ 0 Cl4CtðvpÞ4Cu

where the derivatives of PCP in formulation (15) can be obtained by equation (17)

dkvp dtk

¼

½2=ðtf

À

t0ÞkDkvp

ð17Þ

Formulation (16) can be solved by the GA or SQP algorithm eﬀectively. In formulation (16), it is tempting to conclude that the optimization variables decrease and the equality constraints are eliminated. The VMC method has been developed as a more competitive algorithm in the application of a series of classical optimal control problems in the above literature. However, no research work on trajectory planning in a 3D complex obstacle-rich environment has been

2054

implemented by using this method, and this may face the same challenge as the pseudospectral method in the obstacle shape constraint description.

Analysis of the difficulty in obstacle description by using the above two methods
In both the pseudospectral and VMC methods, it is diﬃcult to describe the obstacles through the mathematical constraints. A cube-shaped obstacle is shown in Figure 2 as an illustration. This type of obstacle may be used in trajectory planning, commonly in an urban environment. The I-beam and triangular prismshaped obstacles are more diﬃcult to describe.
In this subsection, a brief analysis of the diﬃculty is presented. The following method appears to be feasible to describe the obstacle in Figure 2. Point A ¼ [xmin, ymin, zmin] denotes the minimum coordinate point in the six vertex points of the cube-shaped obstacle, and point B ¼ [xmax, ymax, zmax] denotes the maximum coordinate point. q ¼ (x, y, z) denotes the position of the UAV, and the constraints can be written as

x À xmin4Rb1

y À ymin4Rb2

z À zmin4Rb3

Àx þ xmax4Rb4

Ày þ ymax4Rb5

ð18Þ

Àz þ zmax4Rb6

X6 bi45

i¼1

where b are the logical disjunction variables to ensure that at least one inequality is active. The constraints initially appear to be tractable, as the problem is no longer a standard nonlinear parameter optimization problem due to the introduction of the cost function and other nonlinear state constraints. This problem may be similar to a linear mixed integer linear programming problem, but the clear nonlinear characteristics of the cost function and other constraints make it nonideal. Furthermore, if the cube-shaped obstacle requires seven inequalities to be described, then the number of these constraints is 7M, where

Proc IMechE Part G: J Aerospace Engineering 231(11)
the number of nodes is M. This may be unacceptable in a complex and obstacle-rich environment. Hence, the solution method for the traditional optimal control problem may be disabled to address this trajectory-planning problem.
An integrated APF and direct method algorithm
In this section, an integrated APF and direct method algorithm is introduced to solve the diﬃcult situation described above. First, the cost function is built as an important component of the trajectory-planning problem, and the complex constraints of the cluttered obstacle-rich environment are described by the repulsive forces. Then, the optimal control problem without the tedious path constraints owning to introducing the concept of additional control force is solved by the LPM and VMC method. Other direct methods for the optimal control problem may also be eﬀective. Figure 3 shows the technological procedure of this algorithm.
Construction of the cost function
Similar to our previous research in Luo et al.,33 two parts of the cost function are considered in this paper. Instead of the discrete form, the cost function is developed in continuous form. To realize the minimum

AddiƟonal Control Force
Cost FuncƟon
Obstacle constraints in ArƟﬁcial PotenƟal Force
State/Control LimitaƟon

MoƟon EquaƟons

Virtual Prey MoƟon EquaƟons

LPM

VMC

Figure 2. Example of a complex obstacle.

OpiƟmal SoluƟon
Figure 3. Structure of the integrated algorithm. LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Zhang et al.

sum of the acceleration of the UAV, the ﬁrst part of cost function is written as

Z tf

J1 ¼ kakdt

ð19Þ

t0

The second part is the performance index of the total distance of the UAV in ﬂight, which is written as

Z tf

J2 ¼ kvkdt

ð20Þ

t0

where v is the velocity vector of the UAV. The weight method is widely utilized to solve the multi-objective optimization problem. Then, the ﬁnal expression of the total cost function is written as

min J ¼ J1 þ J2

ð21Þ

where the weights  and  may be selected to satisfy the following constraints

0441 ð22Þ
0441

Construction of the constraints
The constraints of the trajectory-planning problem in this paper are divided into three parts: obstacles, UAV limitations, and boundary conditions.

Constraints of obstacles. In this integrated algorithm, the constraints of obstacles are described as the potential ﬁelds induced by the obstacles. The ﬁeld functions are illustrated in section ‘‘Artiﬁcial potential ﬁeld approach’’, and the remaining problem involves calculating the shortest distance between the UAV and each obstacle in real time. There are various algorithms for solving these problems. Here, an optimization method is proposed as an example. Assume that point pn ¼ (pnx, pny, pnz) is the shortest point on the surface of the nth obstacle to the current UAV position point q; then, the shortest distance d can be obtained as follows

d ¼ minðpn À qÞ

ð23Þ

s:t: pn 2 O

The constraints in equation (23) mean that point pn is on the surface O of the nth obstacle. Equation (23) describes an easy optimization problem. This proposed optimization method is qualiﬁed to obtain the shortest distance not only the cube-shaped obstacle, but also I-beam and triangular prism obstacles.

2055

The cube-shaped obstacle shown in Figure 2 is depicted with an illustration to describe the optimization method to solve the shortest distance. This optimization problem can be easily solved by the SQP method.

d ¼8minðpn À qÞ

>< xmin4pnx4xmax

ð24Þ

s:t:>:

ymin4pny4ymax zmin4pnz4zmax

Through solving the shortest distance, the constraints of obstacles can be described as the values of the repulsive force.

Constraints of UAV performance. The constraints must be satisﬁed because of the performance limitations of the UAV. Thus, all of the state variables should be limited by the upper and lower boundaries as follows

xl4x ¼ ðx, y, z, V, , vÞ4xu

ð25Þ

The acceleration constraints of the UAV should be considered because of the limitations of its engine and the structural strength of the UAV body. Because the acceleration is directly determined by the additional control force, the constraints are written as

ul4uadd4uu

ð26Þ

Constraints of the boundary conditions. The boundary values of the UAV trajectory-planning problem are reﬂected in the starting point and target point. The expressions are written as

xðt0Þ ¼ x0

ð27Þ

xðtf Þ ¼ xtf

Formulation derivation by the LPM and VMC
The standard optimal control problem has been built by formulations (21), (10), (25), (26), and (27), and it can be solved by both the LPM and VMC methods. It is described as follows

Z tf

Z tf

min J ¼  kakdt þ  kvkdt

8

t0

t0

>>>>>><

x_ ¼ f ðx; uadd; tÞ xlðkÞ4xðkÞ4xu

ðk

Þ

ð28Þ

s:t:>>>>>>:

ulðkÞ4uaddðk xðt0Þ ¼ x0 xðtfÞ ¼ x

Þ4uu

ðk

Þ

2056

Proc IMechE Part G: J Aerospace Engineering 231(11)

For the LPM, the solution is as proposed in the ‘‘Pseudospectral method’’ section. The ﬁnal form of the nonlinear parameter programming problem is rewritten as

min

J

¼

tf

À 2

t0

 

X M

wkaðkÞ

þ



X M

wkvðkÞ

8 >>>>>>>>>>>>>><

X M DikxðkÞ
k¼0
xlðkÞ4ðxðk

k¼0

k¼0

¼

tf

À 2

t0

fðxðkÞ;

uaddðkÞ;

Þ; yðkÞ; zðkÞ; VðkÞ;

k

Þ

s:t:>>>>>>>>>>>>>>:

ðkÞ; vðkÞÞ4xuðkÞ ulðkÞ4uaddðkÞ4uuðkÞ xð0Þ ¼ x0

;

xðMÞ ¼ xtf

k ¼ 0; 1; . . . ; M

ð29Þ

The nonlinear parameter programming problem (29) after LPM discretization is solved by the ‘‘fmincon’’ package on the MATLAB platform in this paper.
Similarly, the VMC method is introduced to solve the same optimal control problem (28). The reference point will be optimized here, and a trivial guess for the reference point can be (0, 0, 0). The virtual prey motion is represented by a second-order curve, and it is determined by the boundary described in equation (25). The PCP vector is optimized by the ‘‘fmincon’’ package on the MATLAB platform. For the proposed model, xa ¼ (x, y, z) denotes the position state of the UAV in equation (6), and the ﬁrst- and second-order derivatives of xa that describe the velocity and acceleration vectors of the UAV can be obtained by using formulation (14). Then, the speed of the UAV can be calculated by

qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ

V ¼ x_Ta x_a

ð30Þ

where the ﬂight angle, the heading angle and their derivatives can be written as



z_

 ¼ arcsin

ð31Þ

V

y

V ¼ arctan x

ð32Þ

qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ

_ ¼ ð1= 1 À ðz_=VÞ2Þðz€V À z_V_Þ=V2

ð33Þ

_V ¼ ð1=ð1 þ ðy_=x_Þ2ÞÞðy€x_ À x_y€Þ=x_2

ð34Þ

Then, a1, a2, and a3 can be obtained by formulations (31) to (34)



a1 ¼ V_ þ g

z_ V

þ CdV m

qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ

ð1= 1 À ðz_=VÞ2Þðz€V À z_V_Þ

   z_

a2 ¼

V

þ g cos arcsin V

ð1=ð1 þ ðy_=x_Þ2ÞÞðy€x_ À x_y€Þ



  z_

a3 ¼

x_2

V cos arcsin V

ð35Þ

and ax, ay, and az can be derived by the matrix equation (8). Then, the additional control force uadd can be represented by equation (9) as follows

!

Â

Ã

XN

uadd ¼ m ax ay az þ g À Fatt þ Frep

i¼1

ð36Þ

The ﬁnal form of the nonlinear parameter programming problem by the VMC method according to formulation (16) is written as

min J ¼ tf À t0 2

 X M wkqﬃx€ﬃﬃTaﬃﬃﬃx€ﬃﬃaﬃﬃ þ  X M wkqﬃx_ﬃﬃTaﬃﬃﬃx_ﬃﬃaﬃﬃ!

8 >>>< s:t:>>>:

k¼0
Cl4Ctðvp, xrefÞ4Cu ul4uaddðvp, xrefÞ4uu C0ðv0Þ ¼ 0

k¼0

Cf ðvMÞ ¼ 0

ð37Þ

The optimization variables are the PCP variables vp, the reference point xref, and the ﬁnal time tf, and then, the optimal trajectory can be planned by the proposed integrated algorithm.
The numbers of optimization variables and constraints, by both the LPM and VMC, are shown in Table 1. In the LPM, the number of discretization nodes is (M þ 1), and the number of the state variables and control variables is (6 þ 3) Â (M þ 1). In addition, the ﬁnal time variable tf is an optimization variable in this method. Then a total number of the optimization variable is 9(M þ 1) þ 1. The equality constraints include 6(M þ 1) diﬀerential dynamic

Table 1. Numbers of optimization variables and constraints.

Numbers using Numbers using

Item

the LPM

VMC method

Optimization variables Equality constraints Inequality constraints

9(M þ 1) þ 1 6(M þ 1) þ 9 18(M þ 1)

Mþ1þ3þ1 9 18(M þ 1)

LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Zhang et al.

2057

equations constraints, six initial state constraints and three terminal position state constraints. The inequality constraints include the lower and upper boundaries of the 6(M þ 1) state variables and 3(M þ 1) control variables. In the VMC method, the dimension of the optimal control problem is reduced. There are only (M þ 1) PCP nodes, three reference point coordinates and one ﬁnal time variable, which constitute the optimization variables. The diﬀerential dynamic equations have been eliminated owing to the concept of the VMC method, and the number of equality constraints is reduced to 9. The number of inequality constraints is equal to the number of inequality constraints using the LPM method. For both methods, the trajectoryplanning problem has been simpliﬁed by introducing the additional control force to describe the constraints of the complex obstacles.
Simulation and discussion
In order to show the general performance and advantages of the integrated algorithm presented in this paper, a wide range of scenarios are provided. Two categories of simulations are demonstrated: a single obstacle scenario and an obstacle-rich environment. In both simulations, the MATLAB ‘‘fmincon’’ package (7.11-R2011a) is used to solve the parameter optimization. All executions are performed on the same desktop (i5-2400 CPU at a frequency of 3.10 GHz and with 4 GB of random-access memory).
A single obstacle
A.I Different cost performance indexes scenario. In this simulation, a single obstacle model is utilized to

verify the performance of the integrated algorithm in diﬀerent cost performance indexes scenario. Point A, located at [0, 0, 20] m, is selected as the starting point, and point B, located at [180, 180, 60] m, is selected as the target point. The initial velocity is [5, 5, 0] m/s. These three values determine the coeﬃcients of the second-order curve representing the prey motion as follows

x ¼ 0:5l1t2 þ 1t þ 1

y ¼ 0:5l2t2 þ 2t þ 2

ð38Þ

z ¼ 0:5l3t2 þ 3t þ 3

The number of Legendre nodes is 30. The boundary of the additional control force is kuk 4 1. The mass of the UAV is 1.9 kg. The inﬂuence distance is 40 m. The coeﬃcients of the cost function  and  are both 0.5. In scenario 1, the vertexes of the cubeshaped obstacle are located in [60, 60, 0], [120, 60, 0], [120, 140, 0], [60, 140, 0], [60, 60, 50], [120, 60, 50], [120, 140, 50], and [60, 140, 50] m. The results obtained by the three methods are shown in Figure 4. The pink trajectory with small blue ‘‘o’’ represents the solution obtained by the LPM, and the dark blue trajectory with black ‘‘*’’ represents the solution obtained by the VMC method. Both the blue ‘‘o’’ and black ‘‘*’’ represent the discretization nodes. The light blue is the virtual prey motion trajectory. The brown trajectory expresses the solution obtained by the traditional APF method. The time step of the APF method is 0.2 s.
In order to provide the evidences that the presented algorithm has the generality on the diﬀerent cost

Figure 4. Simulation results for minimum distance. APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

2058

Proc IMechE Part G: J Aerospace Engineering 231(11)

Figure 5. Simulation results for minimum flight time. APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Figure 6. Vertical and Lateral simulation results of APF method. APF: artificial potential field.

performance indexes, the cost performance for minimum ﬂight time is utilized. The cost function is as follows

min Jcpr ¼ ts

ð39Þ

where ts is the ﬂight time of the UAV. Other parameters are the same with minimum ﬂight distance scenario. The results obtained by the three methods for minimum ﬂight time are shown in Figure 5.
For more clarity, the vertical and lateral views of individual result by using the three methods for the diﬀerent cost performance indexes are provided in Figures 6 to 8.
The total distance and the ﬂight time of the trajectories obtained by the APF method, integrated

algorithm with LPM and integrated algorithm with VMC method are shown in Table 2. Through the ﬁgures and the table, although there are some slight differences in solving the optimal control problem by the LPM and VMC method, both the ﬂight distance and the ﬂight time obtained by the integrated algorithm are clearly better than that of the APF method. The ﬂight distance for the cost function of minimum distance is less than the distance for the cost function of minimum ﬂight time, while the ﬂight time for the cost function of minimum ﬂight time is less than the result for the cost function of minimum distance. The reason why the distance for the cost function of minimum ﬂight time is longer than that for the minimum distance but the ﬂight time is shorter is comprehensible. This is because that the UAV in the scenario of

Zhang et al.

2059

Figure 7. Vertical and Lateral simulation results of integrated algorithm with LPM. LPM: Legendre pseudospectral method.

Figure 8. Vertical and Lateral simulation results of integrated algorithm with VMC. VMC: virtual motion camouflage.

Table 2. Total distances and flight time of the three methods.

Cost indexes

Algorithm

Distance (m)

Minimum distance Minimum flight time

Traditional APF method Integrated algorithm with LPM Integrated algorithm with VMC method Integrated algorithm with LPM Integrated algorithm with VMC method

307.4375 281.5905 282.6911 291.8303 292.4683

APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Flight time (s)
69.6523 59.4377 59.5583 54.6935 54.2840

minimum ﬂight time is further away from the obstacle than the trajectory for the minimum distance, and the repulsive force which drives the UAV deceleration to avoid the obstacle is smaller. The average velocity of the UAV in the scenario of minimum ﬂight time is faster than the scenario of minimum ﬂight distance, therefore, the ﬂight time consuming is shorter. This

demonstrates that the proposed algorithm is eﬀective for diﬀerent cost performance indexes in this singleobstacle environment. In Figure 9, the partial enlarged ﬁgure about the LPM and VMC method for the minimum ﬂight distance is shown. The result obtained by the VMC method is shown by a dashed line to be distinguished easily.

2060 Scenario A.I shows that the proposed algorithm is
closer to optimal in the cost function of ﬂight distance and ﬂight time. The ﬂight distance is reduced by 7% than the APF methods, and the ﬂight time is reduced by 21%. This can provide that the presented algorithm has the generality on the cost performance indexes. A.II The ability to overcome the local extreme points problem for APF method. Furthermore, the proposed algorithm has an important advantage compared with the traditional APF method in the local maxima problem. In scenario A.II, all of the simulation conditions are
Figure 9. Partial enlarged figure of the algorithm by integrated algorithm. LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Proc IMechE Part G: J Aerospace Engineering 231(11)
the same as in scenario A.I except for the vertex position of the obstacle. The vertexes of the cube-shaped obstacle are located at [60, 60, 0], [120, 60, 0], [120, 140, 0], [60, 140, 0], [60, 60, 60], [120, 60, 60], [120, 140, 60], and [60, 140, 60] m, which means that its maximum height is equal to the target height. The simulation result is presented in Figure 10. The vertical and lateral views of individual result by using the three methods are provided in Figure 11. The local extreme point is shown in the result obtained by the APF method, where the UAV cannot continue trajectory planning. At the position of this point, there is no propulsive force driving the UAV up over the obstacle or driving the UAV around the obstacle toward the left or right. Then, the planning task is prematurely terminated. By the proposed algorithm, the additional control force has ensured that the UAV can escape from the local extreme point. In addition, the solution obtained by the LPM and VMC method in this scenario is similar to the trajectory in scenario A.I, illustrating the eﬃciency of the proposed integrated algorithm for both the LPM and VMC method to some extent. This simulation can illustrate that the proposed algorithm can naturally avoid the local extreme point problem.
A.III The ability to ensure the optimality for unspecified parameters of potential function. Since the traditional APF method is heavily dependent on the parameters values of the potential function, the unspeciﬁed parameters scenario is introduced to show the presented algorithm’s robustness in this simulation. Three different groups of parameters of the repulsive potential function that include"and l are utilized. The shape of the obstacle is triangular prism and the vertexes of the

Figure 10. Simulation result of scenario A.II. APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Zhang et al.

2061

Figure 11. Vertical and lateral simulation results by the APF method. APF: artificial potential field.

Table 3. The values of the parameters for the potential field function.

Algorithm

"

l

I-APF, I-Integrated Algorithm (I-IA)

35

0.58

II-APF, II-Integrated Algorithm (II-IA)

50

0.38

III-APF, III-Integrated Algorithm (III-IA)

70

0.18

triangular prism-shaped obstacle are located in [70, 50, 0], [140, 50, 0], [80, 150, 0], [70, 50, 60], [140, 50, 60], [80, 150, 60] m. Through the diﬀerent groups of parameters, the results obtained by using the APF method are signiﬁcantly diﬀerent, while the integrated method can ensure the performance of the trajectory planning results. Table 3 shows the values of the different parameters. Both the traditional APF method and integrated algorithm have been implemented by the three groups of parameters. I-Integrated Algorithm, II-Integrated Algorithm, and III-Integrated Algorithm utilize the same parameters with the three groups of parameters for I-APF, II-APF, and III-APF respectively.
Figure 12 shows the results obtained by the three groups of parameters of potential ﬁeld function. Only the integrated algorithm by using the LPM is shown for the sake of brevity.
Figure 13 represents the vertical and the lateral views for the simulation results of the diﬀerent parameters by the APF method and integrated algorithm. The curves in the same color are obtained by the same parameters but by diﬀerent algorithms. The solid lines represent the results obtained by the integrated algorithm and the dash lines represent the results obtained by the individual APF method.
The results shown in Figures 12 and 13 illustrate that diﬀerent parameters inﬂuence the results of trajectory planning by the APF method signiﬁcantly. In contrast, the integrated algorithm can ensure the ﬂight distance performance of trajectory planning and the

results are coincident approximately. The results of III-Integrated Algorithm have some diﬀerences with I-Integrated Algorithm and II-Integrated Algorithm, and this is because that the additional control force is limited by the upper and lower boundaries constraints. Since the parameters of ﬁeld function are arbitrary within a certain range, the additional control force and the optimization algorithm can ensure the better performance of the trajectory planning under the premise of meeting the requirements of constraints. The results of ﬂight distance for individual APF and the integrated algorithm by three groups of diﬀerent parameters are shown in Table 4. It shows that the cost performance for the integrated algorithm is better than the APF method, and the diﬀerences between the three results obtained by the integrated algorithm are slighter than the results obtained by the APF method.
Obstacle-rich environment
B.I The trajectory planning in the complex obstacle-rich environment. This scenario is the UAV trajectory planning in a complex obstacle-rich environment. The following diﬀerently shaped obstacles are assumed in the three-dimensional space. Point A located at [50, 50, 20] m is selected as the start point, and point B located at [950, 800, 80] m is selected as the target point. The initial velocity is [0, 5, 0] m/s. The inﬂuence distance of the obstacle is 50 m. The coeﬃcients of the secondorder curve can be obtained in the same manner. Both the coeﬃcients of the cost function  and  are 0.5, which means that the two cost functions have equal weights. All other simulation parameters are equal to the corresponding parameters in subsection ‘‘A single obstacle’’. The simulation result is presented in Figures 14 and 15.
Figure 14 shows the rich and complex obstacles and the trajectories obtained by the traditional APF method and the integrated algorithm based on the

2062

Proc IMechE Part G: J Aerospace Engineering 231(11)

Figure 12. Simulation results of different parameters of the field function. APF: artificial potential field.

Figure 13. Vertical and lateral simulation results of different parameters of field function. APF: artificial potential field.

Table 4. Total distances of the APF and integrated methods.

Distance

Algorithm (m)

Algorithm

Distance (m)

I-APF II-APF III-APF

310.2941 317.7435 329.5649

I-Integrated Algorithm II-Integrated Algorithm III-Integrated Algorithm

295.2584 295.3769 299.4937

LPM and VMC method. Both algorithms are competent for trajectory planning. Figure 15 represents the vertical and lateral views of Figure 14. The pink trajectory with the small blue ‘‘o’’ represents the solution obtained by the LPM, and the dark blue trajectory with the black ‘‘*’’ represents the solution obtained by the VMC method. The brown trajectory indicates the

solution obtained by the APF method. The total distances of the trajectories obtained by the APF method, LPM, and VMC method are shown in Table 5.
The total distances obtained by the LPM and VMC method are shorter than that obtained with the APF method because the additional force can oﬀset a portion of the repulsive force, which drives the UAV to ﬂy along the detour. The oﬀset will be ignored when the UAV is suﬃciently close to the obstacles because of the increasing repulsive force. This approach can ensure that the UAV will not collide with the obstacles. The simulation has demonstrated that the proposed algorithm is qualiﬁed to solve the cluttered obstacle-rich environment since the distance is reduced by 5.7%. Figure 16 is the partial enlarged ﬁgure, which shows the diﬀerence between the LPM and VMC method. The convergence of the optimal

Altitude(m)
North(m)

Zhang et al.

control problem reduces the region in which the obstacles are rich and complex.

B.II The efficiency comparison between the integrated algorithm and individual LPM. In this simulation, the eﬃciency of the integrated algorithm and traditional optimal control method by using individual LPM as an example is provided. In order to utilize the optimal control problem to solve the trajectory planning in obstacle-rich environment, the p-norm method29 is applied by ignoring the accuracy when describing the obstacles approximately. For the problem of describing the constraints of obstacles, the cubed-shaped obstacles are expressed by the following equation

hðx,

y,

zÞ

¼



x À xc k1 þ bs

,

y À yc k1 þ bs

,

z À zc k1 þ bs

pÀkp4
p

ð40Þ

200

100

0 1000

800

600

400

North(m)

200 00

1000 800 600 400 200
East(m)

Figure 14. Simulation results of an obstacle-rich environment.

2063

where h represents the obstacle constraints, and the
deﬁnitions of other parameters are the same with Gu et al.29 The p-norm is deﬁned as follows

ðx, y, zÞp¼ ðkxkpþ ypþkzkpÞ1=p

ð41Þ

Table 5. Total distances of the three methods.

Algorithm

Distance (m)

Traditional APF Integrated algorithm using the LPM Integrated algorithm using the VMC method

1218.3995 1141.4573 1142.2876

APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

540
APF
520

500

480

VMC

460

440

LPM

420 440 460 480 500 520 East(m)
Figure 16. Partial enlarged figure of the three methods in an obstacle-rich environment. APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Nort h(m ) Altitude(m)

(a) 1000
900 800 700 600 500 400 300 200 100
0 0

VMC

(b) 100
90

80

70

APF

60

50

40
LPM
30

20

10

0

200

400

600

800

1000

0

East(m)

APF
LPM VMC

200

400

600

East(m)

Figure 15. Vertical and lateral simulation results of an obstacle-rich environment. APF: artificial potential field; LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

800

1000

2064
It is worth noting that the p-norm method can describe the simple-shaped obstacles such as circles, rectangles and ellipses etc. Therefore, in order to utilize the p-norm method, three rectangles-shaped obstacles are used to implement the simulation. The target position is the same with the single obstacle scenario. The vertexes of the rectangles-shaped obstacle are located in [40, 60, 0], [40, 120, 0], [80, 60, 0], [80 120, 0], [40, 60, 50], [40, 120, 50], [80, 60, 50], [80 120, 50] m, [100, 80, 0], [100, 140, 0], [150, 80, 0], [150, 140, 0], [100, 80, 55], [100, 140, 55], [150, 80, 55], [150 140, 55] m, and [120, 30, 0], [120, 65, 0], [170, 65, 0], [170, 30, 0], [120, 30, 60], [120, 65, 60], [170, 65, 60], [170, 30, 60] m, respectively. The results are shown in Figure 17, and Figure 18 represents the vertical and lateral views of the simulation result in this scenario.

Proc IMechE Part G: J Aerospace Engineering 231(11)
Through the simulation results, the pink trajectory with small blue ‘‘o’’ represents the solution obtained by the integrated method with LPM, and the dark blue trajectory with black ‘‘*’’ represents the solution obtained by the integrated method with VMC method. Both the blue ‘‘o’’ and black ‘‘*’’ represent the discretization nodes. For the individual LPM, a total of eight times simulations are carried on by the diﬀerent initial guess solutions, and the upper boundary of the operating time is limited by 15 min. Unfortunately, there are only two simulations which can obtain the results. The red and brown trajectories represent the two results. Other simulations are the state of ‘‘no feasible solution’’ or cannot ﬁnish the planning in the given time. In contrast, both the trajectory planning problems solved by the integrated

Figure 17. Simulation results for the integrated algorithm and individual LPM. LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.
Figure 18. Vertical and lateral simulation results for the integrated algorithm and individual LPM. LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

Zhang et al.

Table 6. The results of the integrated algorithm and individual LPM.

Algorithm

Flight

Operating Percentage

distance (m) time (s) of success

Integrated algorithm with LPM
Integrated algorithm with VMC method
Individual LPM
(Other 6 times simulations)

281.9474 282.2405 282.3547 281.4839 281.9274 281.5763 282.9374 285.3803 NULL

120.3932 100 113.4569 117.9973 97.3864 100 100.9651 95.0762 784.5280 25 692.9748 NULL

LPM: Legendre pseudospectral method; VMC: virtual motion camouflage.

algorithm with LPM and VMC method can ﬁnish in 3 min with three times simulations. The reason for the diﬀerence is that the obstacle constraints make the optimization problem more diﬃcult although the expression of obstacle has been approximated. Three obstacles can be described approximately by three expressions using equation (40), and the number of the constraints is increased by 90 since the number of the nodes is 30 in this simulation. This increases the diﬃculty of the solution obviously and the success rate is not satisﬁed by the individual LPM method. The simulation illustrates that the integrated algorithm is more eﬀective since the obstacle constraints are eliminated by introducing the concept of APF method into the optimal control problem.
The data results are shown in Table 6. The table shows that the integrated algorithm has the advantages on both the cost performance indexes and the operating time when solving the trajectory planning problem, and the percentage of success is better than the individual optimal control problem by using the LPM obviously. The ‘‘NULL’’ in Table 6 represents that there is no result by using the corresponding algorithm. Through the column of the ﬂight distance performance, it shows that the results obtained by the integrated algorithm are in a small error range, while the results obtained by the individual LPM have larger diﬀerences. The reason is that the huge number of constraints inﬂuences the convergence of the optimization algorithm. It is worth noting that the operating time by the integrated algorithm with VMC method is shorter than the integrated algorithm with LPM, this is because the principle of the VMC method eliminates the state equation constraints of the UAV. Then the number of constraints of optimal control problem is reduced, and the operating time is shorter.
Through the simulations in a wide range of scenarios, the integrated algorithm presented in this paper

2065
has some general better performance and obvious advantages than the individual APF method and optimal control method. In the trajectory planning problem, the cost indexes are the important metrics to evaluate the performance of the algorithm. Scenario A.I shows that the integrated algorithm can solve different cost indexes, and both the ﬂight distance and ﬂight time have the better performance than the traditional APF method. Scenario A.II shows that the local extreme points problem can be overcome by the additional control force, and this method has the advantage than the harmonic potential function method and random motion method since the values of the control force are obtained by optimization algorithm. This is meaningful to ensure the optimality of trajectory planning. Scenario A.III shows the robustness of the presented algorithm since the APF method is heavily dependent on the parameters of the ﬁeld function. The additional control force and optimization algorithm can oﬀset the adverse eﬀects generated by the improper parameters within the boundaries values of the additional control force. From another viewpoint, scenario A.III provides that the integrated algorithm has the generality for dealing with the scenario on diﬀerent size, shape and position of the obstacle. In the obstacle-rich environment, the trajectory planning problem can be solved by the integrated algorithm with the LPM and VMC method which the cost performance is better than the APF method, and the slight diﬀerence between the two integrated algorithms can provide some evidences on the convergence of the algorithm to some extent in scenario B.I. In scenario B.II, the simulation on the eﬃciency between the integrated algorithm and individual LPM is shown. The operating time and the percentage of success have the signiﬁcant advantages compared with the LPM method, since the constraints of the obstacles are eliminated by introducing the concept of APF method into the optimal control problem. In the meantime, the cost performance index on the ﬂight distance is better than the individual LPM.
In summary, the integrated APF and direct method is improved compared to both individual methods in several respects. However, the initial estimates for the optimal control problem in this simulation inﬂuence the solution of the LPM, and the arbitrary estimates may lead to an infeasible solution or large time consumption. This topic should be considered in future work.
Conclusions
In this paper, an integrated APF and direct method algorithm is presented to solve the trajectory-planning problem in a cluttered obstacle-rich environment. The diﬃculty of the individual APF method, LPM or VMC method for solving the planning problem with complex obstacles is also analyzed from diﬀerent

2066
perspectives. An additional control force is introduced to transform the gradient solving planning problem into the optimal control problem, and the constraints of the obstacles are substituted by the potential force model. Both the LPM and VMC algorithms are employed to solve the modiﬁed trajectory planning model. The advantages of the proposed strategy are notable: (1) A relatively reasonable and more realistic UAV dynamics model for the traditional APF method is considered in the trajectory planning based on this algorithm; (2) The local extreme point can be avoided by the concept additional control force through a novel strategy; (3) A more optimal result of the trajectory planning compared with the traditional APF method can be ensured by the integrated algorithm for the unspeciﬁed potential function; (4) The constraints of obstacles with complex shapes are eliminated by the potential force in the optimal control problem; (5) Trajectory planning in the cluttered obstacle-rich environment can be handled to oﬀset the shortcomings of the traditional optimal control methods, including the LPM and VMC method.
Declaration of Conflicting Interests
The author(s) declared no potential conﬂicts of interest with respect to the research, authorship, and/or publication of this article.
Funding
The author(s) disclosed receipt of the following ﬁnancial support for the research, authorship, and/or publication of this article: This work was supported by a grant from the National Natural Science Foundation of China (No. 61350010).
References
1. Andrew JB, Jeremy H, Ian P, et al. Situation aware trajectory tracking for micro air vehicles in obstacle-rich environments. In: AIAA guidance, navigation, and control conference, AIAA, Chicago, Illinois, 2009.
2. Zeitz FH. UCAV path planning in the presence of radarguided surface-to-air missile threats. PhD Dissertation, The University of Michigan, USA, 2005.
3. Laszlo T and Craig AW. Minimum-time path planning for unmanned aerial vehicles in steady uniform winds. J Guid Control Dyn 2009; 32: 1736–1746.
4. Ran D and John ECJ. Three-dimensional trajectory optimization in constrained airspace. J Aircraft 2009; 46: 627–634.
5. Reza K and Ehsan T. Aircraft optimal terrain/threatbased trajectory planning and control. J Guid Control Dyn 2014; 37: 466–483.
6. Fahroo F and Ross IM. Costate estimation by a Legendre pseudospectral method. J Guid Control Dyn 2001; 24: 270–275.
7. Jackiewicz Z and Welfert BD. Stability of Gauss-Radau pseudospectral approximations of the one-dimensional wave equation. J Scient Comput 2003; 18: 287–313.
8. Geoffrey TH and Anil VR. Optimal reconfiguration of spacecraft formations using the Gauss pseudospectral method. J Guid Control Dyn 2008; 31: 689–698.

Proc IMechE Part G: J Aerospace Engineering 231(11)
9. David B. A Gauss pseudospectral transcription for optimal control. PhD Dissertation, Massachusetts Institute of Technology, USA, February 2005.
10. Jeremy R. Launch vehicle trajectory optimization using a Legendre pseudospectral method. In: AIAA guidance, navigation, and control conference and exhibit, AIAA, Austin, TX, USA, 2003.
11. Boyarko G, Yakimenko O and Romano M. Optimal rendezvous trajectories of a controlled spacecraft and a tumbling object. J Guid Control Dyn 2011; 34: 1239–1252.
12. Paul W. Three-dimensional aircraft terrain-following via real-time optimal control. J Guid Control Dyn 2007; 30: 1201–1205.
13. Rezaee H. Adaptive artificial potential field approach for obstacle avoidance of unmanned aircrafts. In: 2012 IEEE/ASME international conference on the advanced intelligent mechatronics, Kachsiung, Taiwan, July 2012. IEEE.
14. Sivaranjinni S, Cunjia L and Chen WH. Optimizationbased safety analysis of obstacle avoidance systems for unmanned aerial vehicles. J Intell Robot Syst 2012; 65: 219–231.
15. Satoh K. Collision avoidance in multi-dimensional space using Laplace potential. In: Proceedings of preprint of 15th annual conference of the Robotics Society of Japan, 1987, pp.155–156.
16. Connolly CI, Burns JB and Weiss R. Path planning using Laplace’s equation. In: Proceedings of the IEEE international conference on robotics and automation, Vol. 3, Cincinnati, OH, USA, 1995, pp.2102–2106. IEEE.
17. Masoud A. Techniques in potential-based path planning. Canada: Queen’s University, 1995.
18. Trevisan M, Idiart MA, Prestes E, et al. Exploratory navigation based on dynamical boundary value problems. J Intell Robot Syst 2006; 45: 101–114.
19. Charifa S and Bikdash M. Comparison of geometrical, kinematic, and dynamic performance of several potential field methods. In: Proceedings of the 2009 IEEE Southeast conference, Atlanta, GA, USA, 2009, pp.8–23. IEEE.
20. Barraquand J and Latombe JC. A Monte-Carlo algorithm for path planning with many degrees of freedom. In: Proceedings of the 1990 IEEE international conference on robotics and automation, Vol. 3, Cincinnati, OH, USA, 1990, pp.1712–1717.
21. Chang H. A new technique to handle local minimum for imperfect potential field based motion planning. In: Proceedings of the 1996 IEEE international conference on robotics and automation, Vol. 1, Minneapolis, MN, USA 1996, pp.108–112.
22. Eun Y and Bang H. Cooperative control of multiple unmanned aerial vehicles using the potential field theory. J Aircraft 2006; 43: 1805–1814.
23. Mora MC and Tornero J. Path planning and trajectory generation using multi-rate predictive artificial potential fields. In: 2008 IEEE/RSJ international conference on intelligent robots and systems, Acropolis Convention Center, Nice, France, 2008, pp.2990–2995.
24. Ghose K, Horiuchi TK, Krishnaprasad PS, et al. Echolocating bats use a nearly time optimal strategy to intercept prey. PLOS Biol 2006; 4: 0865–0873.

Zhang et al.

25. Varsakelis DH and Shao C. A bio-inspired pursuit strategy for optimal control with partially constrained final state. Automatica 2007; 43: 1265–1273.
26. Xu YJ. Virtual motion camouflage and suboptimal trajectory design. In: AIAA guidance, navigation, and control conference and exhibit, AIAA, Hilton Head, SC, USA, 2007.
27. Xu YJ and Gareth B. Sequential virtual motion camouflage method for nonlinear constrained optimal trajectory control. Automatica 2012; 48: 1273–1285.
28. Xu YJ. Analytical solutions to spacecraft formation flying guidance using virtual motion camouflage. J Guid Control Dyn 2010; 33: 1376–1386.
29. Gu X, Shen L, Chen J, et al. A virtual motion camouflage approach for cooperative trajectory planning of multiple UCAVs. Math Prob Eng 2014; 4: 1–15.
30. Chen YB, Luo GC, Mei YS, et al. UAV path planning using artificial potential field method updated by optimal control theory. Int J Syst Sci 2016; 47(6): 1407–1420.
31. Lin CL, Li YH and Aouf N. Potential-field-based evolutionary route planner for the control of multiple unmanned aerial vehicles. Proc IMechE, Part G: J Aerospace Engineering 2010; 224: 1229–1242.
32. Espen O and Raymond KI. Collision and terrain avoidance for UAVs using the potential field method. In: IEEE aerospace conference, IEEE Computer Society, Washington, DC, USA, 2013.
33. Luo GC, Yu JQ, Mei YS, et al. UAV path planning in mixed-obstacle environment via artificial potential field method improved by additional control force. Asian J Control 2015; 17: 1600–1610.
34. Tobias P, Thomas RK and Jan TG. UAV formation flight using 3D potential field. In: 16th mediterranean conference on control and automation, Congress Centre, Ajaccio, France, 2008.
35. Xu YJ and Gareth B. Pre and post optimality checking of the virtual motion camouflage based nonlinear constrained subspace optimal control. In: AIAA guidance, navigation, and control conference, AIAA, Chicago, IL, USA, 2009.
36. Xu YJ and Gareth B. Virtual motion camouflage based phantom track generation through cooperative electronic combat air vehicles. Automatica 2010; 46: 1454–1461.

Appendix
Notation

a a1
a2
a3
ax, ay, az
b Cd Cl, Cu

acceleration vector of UAV tangent component of acceleration along the body frame vertical component of the normal acceleration along the body frame horizontal component of the normal acceleration along the body frame components of acceleration along the inertial axis logical disjunction variable damping force coefficient lower and upper boundaries of the optimal control problem

2067

C0, Cf d
d0 D DUAV
g f Fatt, Frep i j J k ka
L
L m M N O pi
ptarget q R T u uadd Uatt, Urep v vp V
w
x xa xsr xref xp x, y, z
xb, yb, zb
,  ", l 
v
l, ,  
 #k

initial and terminal state constraints Euclidean distance between the UAV’s position and the target position influence threshold of the obstacle differential matrix damping force of the UAV caused by the atmosphere gravitational acceleration state differential equations attractive and repulsive forces identification number of the obstacles waypoint index cost function order of the nodes parameter that influences the attractive force magnitude integral performance of the Lagrange problem rotation matrix mass of the UAV number of nodes total number of obstacles surface expression of the obstacle effective point position on the surface of the ith obstacle target point position UAV point current position a large numeral thrust force generated by the engine control vector additional control force vector attractive and repulsive field functions velocity vector of UAV PCP vector speed of the UAV (magnitude of velocity vector) weight for the Legendre–Gauss– Lobatto nodes state variable vector position state vector state rate vector reference point position vector virtual prey motion vector position coordinates along the inertial axis position coordinates along the UAV body axis
weight parameters of cost function parameter of repulsive field function terminal performance of Mayer problem heading angle of the UAV parameters of the quadratic curve Legendre–Gauss–Lobatto point in the interval [ À 1, 1] flight path angle of the UAV PCP node

